{"prompt": "Question: Find total sales by each employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('employee_id')['quantity'].sum()"}
{"prompt": "Question: Get the average price of each product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['price'].mean()"}
{"prompt": "Question: Filter rows where quantity sold is greater than 10.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['quantity'] > 10]"}
{"prompt": "Question: Sort the dataset by sale_date in descending order.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.sort_values('sale_date', ascending=False)"}
{"prompt": "Question: Find the maximum price for each product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['price'].max()"}
{"prompt": "Question: Merge df with another dataframe df_customers on customer_id.\nColumns: employee_id, product_id, quantity, price, sale_date, customer_id\n\nAnswer:", "completion": "df.merge(df_customers, on='customer_id')"}
{"prompt": "Question: Count the number of sales transactions per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('employee_id').size()"}
{"prompt": "Question: Fill missing values in the price column with the mean price.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['price'].fillna(df['price'].mean(), inplace=True)"}
{"prompt": "Question: Select only employee_id, product_id, and quantity columns.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[['employee_id', 'product_id', 'quantity']]"}
{"prompt": "Question: Find the total revenue (quantity * price) for each employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.assign(revenue=df['quantity']*df['price']).groupby('employee_id')['revenue'].sum()"}
{"prompt": "Question: Filter rows where sale_date is in 2024.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['sale_date'].dt.year == 2024]"}
{"prompt": "Question: Get the first 5 rows of the dataset.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.head(5)"}
{"prompt": "Question: Get the last 5 rows of the dataset.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.tail(5)"}
{"prompt": "Question: Find the average quantity sold for each product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['quantity'].mean()"}
{"prompt": "Question: Drop rows where price is missing.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.dropna(subset=['price'])"}
{"prompt": "Question: Rename column product_id to item_id.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.rename(columns={'product_id':'item_id'})"}
{"prompt": "Question: Create a new column total_cost as quantity multiplied by price.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['total_cost'] = df['quantity'] * df['price']"}
{"prompt": "Question: Get unique product_ids sold.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['product_id'].unique()"}
{"prompt": "Question: Find rows where quantity is between 5 and 15.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['quantity'].between(5, 15)]"}
{"prompt": "Question: Count distinct products sold by each employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('employee_id')['product_id'].nunique()"}
{"prompt": "Question: Pivot table showing total quantity for each employee per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.pivot_table(index='employee_id', columns='product_id', values='quantity', aggfunc='sum')"}
{"prompt": "Question: Add a column 'high_price' which is True if price > 100.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['high_price'] = df['price'] > 100"}
{"prompt": "Question: Filter rows where product_id is 'P123'.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['product_id'] == 'P123']"}
{"prompt": "Question: Find the minimum quantity sold per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['quantity'].min()"}
{"prompt": "Question: Sort the dataset by quantity ascending and then price descending.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.sort_values(['quantity', 'price'], ascending=[True, False])"}
{"prompt": "Question: Remove duplicate rows based on employee_id and product_id.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.drop_duplicates(subset=['employee_id', 'product_id'])"}
{"prompt": "Question: Create a column 'month' from sale_date.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['month'] = df['sale_date'].dt.month"}
{"prompt": "Question: Count number of sales per month.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby(df['sale_date'].dt.month).size()"}
{"prompt": "Question: Filter rows where price is not null.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['price'].notnull()]"}
{"prompt": "Question: Get summary statistics for quantity and price.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[['quantity', 'price']].describe()"}
{"prompt": "Question: Merge df with df_suppliers on product_id using left join.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.merge(df_suppliers, on='product_id', how='left')"}
{"prompt": "Question: Filter rows where employee_id is in [101, 102, 103].\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['employee_id'].isin([101, 102, 103])]"}
{"prompt": "Question: Round the price column to 2 decimal places.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['price'] = df['price'].round(2)"}
{"prompt": "Question: Replace missing quantities with 0.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['quantity'].fillna(0, inplace=True)"}
{"prompt": "Question: Create a column 'revenue_category' based on total_cost > 500.\nColumns: employee_id, product_id, quantity, price, sale_date, total_cost\n\nAnswer:", "completion": "df['revenue_category'] = df['total_cost'].apply(lambda x: 'High' if x > 500 else 'Low')"}
{"prompt": "Question: Find the top 3 employees by total revenue.\nColumns: employee_id, product_id, quantity, price, sale_date, total_cost\n\nAnswer:", "completion": "df.groupby('employee_id')['total_cost'].sum().nlargest(3)"}
{"prompt": "Question: Select rows where sale_date is after 2024-01-01.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['sale_date'] > '2024-01-01']"}
{"prompt": "Question: Calculate cumulative sum of quantity for each employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.sort_values('sale_date').groupby('employee_id')['quantity'].cumsum()"}
{"prompt": "Question: Get the total quantity and total revenue per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.assign(revenue=df['quantity']*df['price']).groupby('product_id').agg({'quantity':'sum','revenue':'sum'})"}
{"prompt": "Question: Filter rows where total_cost is between 100 and 500.\nColumns: employee_id, product_id, quantity, price, sale_date, total_cost\n\nAnswer:", "completion": "df[df['total_cost'].between(100, 500)]"}
{"prompt": "Question: Count number of unique employees per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['employee_id'].nunique()"}
{"prompt": "Question: Find average price for each month.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby(df['sale_date'].dt.month)['price'].mean()"}
{"prompt": "Question: Create a flag column 'big_sale' if quantity > 20.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['big_sale'] = df['quantity'] > 20"}
{"prompt": "Question: Select rows where employee_id is not 105.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['employee_id'] != 105]"}
{"prompt": "Question: Sort products by total revenue descending.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.assign(revenue=df['quantity']*df['price']).groupby('product_id')['revenue'].sum().sort_values(ascending=False)"}
{"prompt": "Question: Find total sales by each employee.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id')['quantity'].sum()"}
{"prompt": "Question: Get the average price of each product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id')['price'].mean()"}
{"prompt": "Question: Filter sales with quantity greater than 10.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] > 10]"}
{"prompt": "Question: Sort sales by price in descending order.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.sort_values('price', ascending=False)"}
{"prompt": "Question: Calculate total revenue per sale.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['quantity'] * df['price']"}
{"prompt": "Question: Count the number of sales per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id').size()"}
{"prompt": "Question: Select only employee_id and sale_date columns.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[['employee_id', 'sale_date']]"}
{"prompt": "Question: Find the maximum quantity sold per product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id')['quantity'].max()"}
{"prompt": "Question: Filter sales after 2023-01-01.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'] > '2023-01-01']"}
{"prompt": "Question: Calculate total revenue by employee.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id').apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Find the earliest sale date.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['sale_date'].min()"}
{"prompt": "Question: Get unique product IDs.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['product_id'].unique()"}
{"prompt": "Question: Count sales where price is above 100.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['price'] > 100].shape[0]"}
{"prompt": "Question: Pivot table of total quantity by employee and product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.pivot_table(values='quantity', index='employee_id', columns='product_id', aggfunc='sum')"}
{"prompt": "Question: Fill missing prices with the mean price.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['price'].fillna(df['price'].mean())"}
{"prompt": "Question: Find employees with total sales above 100 units.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id').filter(lambda x: x['quantity'].sum() > 100)"}
{"prompt": "Question: Get the top 5 sales by price.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.nlargest(5, 'price')"}
{"prompt": "Question: Calculate the median quantity sold per product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id')['quantity'].median()"}
{"prompt": "Question: Filter sales with revenue above 500.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] * df['price'] > 500]"}
{"prompt": "Question: Sort by sale date in ascending order.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.sort_values('sale_date')"}
{"prompt": "Question: Find total quantity sold per sale date.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('sale_date')['quantity'].sum()"}
{"prompt": "Question: Select rows where product_id is in a specific list.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['product_id'].isin(['P1', 'P2', 'P3'])]"}
{"prompt": "Question: Calculate cumulative quantity sold per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id')['quantity'].cumsum()"}
{"prompt": "Question: Drop rows with missing sale_date.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.dropna(subset=['sale_date'])"}
{"prompt": "Question: Find employees with no sales.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] == 0]['employee_id'].unique()"}
{"prompt": "Question: Get the last sale for each employee.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id').last()"}
{"prompt": "Question: Calculate average revenue per sale.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "(df['quantity'] * df['price']).mean()"}
{"prompt": "Question: Filter sales with quantity between 5 and 15.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'].between(5, 15)]"}
{"prompt": "Question: Find the total price for each product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id')['price'].sum()"}
{"prompt": "Question: Replace negative quantities with 0.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['quantity'].clip(lower=0)"}
{"prompt": "Question: Find sales with price below the average price.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['price'] < df['price'].mean()]"}
{"prompt": "Question: Group by sale_date and count unique products.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('sale_date')['product_id'].nunique()"}
{"prompt": "Question: Merge with another dataframe on employee_id.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.merge(df2, on='employee_id')"}
{"prompt": "Question: Find the latest sale date for each product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id')['sale_date'].max()"}
{"prompt": "Question: Calculate the standard deviation of price per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id')['price'].std()"}
{"prompt": "Question: Filter sales where quantity is not null.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'].notnull()]"}
{"prompt": "Question: Find the top 3 employees by total quantity sold.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id')['quantity'].sum().nlargest(3)"}
{"prompt": "Question: Calculate total revenue by sale date.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('sale_date').apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Select rows with specific employee IDs.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['employee_id'].isin(['E1', 'E2'])]"}
{"prompt": "Question: Find the minimum price per product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id')['price'].min()"}
{"prompt": "Question: Drop duplicate sales by employee_id and sale_date.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.drop_duplicates(subset=['employee_id', 'sale_date'])"}
{"prompt": "Question: Calculate the total quantity sold in 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].str.contains('2023')]['quantity'].sum()"}
{"prompt": "Question: Find sales with quantity equal to the maximum quantity.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] == df['quantity'].max()]"}
{"prompt": "Question: Pivot table of average price by employee and product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.pivot_table(values='price', index='employee_id', columns='product_id', aggfunc='mean')"}
{"prompt": "Question: Replace missing quantities with 1.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['quantity'].fillna(1)"}
{"prompt": "Question: Find employees with average price above 50.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id').filter(lambda x: x['price'].mean() > 50)"}
{"prompt": "Question: Sort by quantity and price.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.sort_values(['quantity', 'price'])"}
{"prompt": "Question: Count sales per product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id').size()"}
{"prompt": "Question: Find sales where price is in the top 10%.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['price'] >= df['price'].quantile(0.9)]"}
{"prompt": "Question: Calculate the total revenue for each employee in 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].str.contains('2023')].groupby('employee_id').apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Find the total quantity sold for each product on weekends.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.dayofweek >= 5].groupby('product_id')['quantity'].sum()"}
{"prompt": "Question: Calculate the average quantity sold per sale.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['quantity'].mean()"}
{"prompt": "Question: Filter sales where the price is above the median price.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['price'] > df['price'].median()]"}
{"prompt": "Question: Group by employee and find the most recent sale date.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id')['sale_date'].max()"}
{"prompt": "Question: Calculate the total revenue for sales in Q1 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].between('2023-01-01', '2023-03-31')].apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Find products with total sales above 500 units.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id').filter(lambda x: x['quantity'].sum() > 500)"}
{"prompt": "Question: Select rows where quantity is an even number.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] % 2 == 0]"}
{"prompt": "Question: Find the total revenue for each product in 2022.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].str.contains('2022')].groupby('product_id').apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Calculate the variance of price per product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id')['price'].var()"}
{"prompt": "Question: Find sales with the lowest 5 prices.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.nsmallest(5, 'price')"}
{"prompt": "Question: Create a new column for revenue per sale.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['revenue'] = df['quantity'] * df['price']"}
{"prompt": "Question: Filter sales where employee_id starts with 'E1'.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['employee_id'].str.startswith('E1')]"}
{"prompt": "Question: Find the total quantity sold by each employee on Mondays.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.dayofweek == 0].groupby('employee_id')['quantity'].sum()"}
{"prompt": "Question: Calculate the average revenue per product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id').apply(lambda x: (x['quantity'] * x['price']).mean())"}
{"prompt": "Question: Find sales where quantity equals the minimum quantity.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] == df['quantity'].min()]"}
{"prompt": "Question: Sort by sale_date descending and employee_id ascending.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.sort_values(['sale_date', 'employee_id'], ascending=[False, True])"}
{"prompt": "Question: Count unique employees per product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id')['employee_id'].nunique()"}
{"prompt": "Question: Filter sales where price is not in the bottom 25%.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['price'] > df['price'].quantile(0.25)]"}
{"prompt": "Question: Calculate the cumulative revenue per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id').apply(lambda x: (x['quantity'] * x['price']).cumsum())"}
{"prompt": "Question: Replace prices above 1000 with 1000.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['price'].clip(upper=1000)"}
{"prompt": "Question: Find the top 10 sales by revenue.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.assign(revenue=df['quantity'] * df['price']).nlargest(10, 'revenue')"}
{"prompt": "Question: Group by sale_date and calculate max price.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('sale_date')['price'].max()"}
{"prompt": "Question: Filter sales with non-null product_id.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['product_id'].notna()]"}
{"prompt": "Question: Find employees with sales on more than 5 dates.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id').filter(lambda x: x['sale_date'].nunique() > 5)"}
{"prompt": "Question: Calculate the total quantity sold in the last 30 days.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'] >= df['sale_date'].max() - pd.Timedelta(days=30)]['quantity'].sum()"}
{"prompt": "Question: Find the average price per sale date.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('sale_date')['price'].mean()"}
{"prompt": "Question: Select rows where sale_date is a Friday.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.dayofweek == 4]"}
{"prompt": "Question: Calculate the total revenue for sales with quantity above 20.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] > 20].apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Find the first sale for each product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id').first()"}
{"prompt": "Question: Drop rows where price is zero.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['price'] != 0]"}
{"prompt": "Question: Find products with average quantity sold above 10.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id').filter(lambda x: x['quantity'].mean() > 10)"}
{"prompt": "Question: Calculate the median price per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id')['price'].median()"}
{"prompt": "Question: Filter sales from the first quarter of any year.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.quarter == 1]"}
{"prompt": "Question: Find the total quantity sold per employee in January 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].str.contains('2023-01')].groupby('employee_id')['quantity'].sum()"}
{"prompt": "Question: Replace negative prices with the median price.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['price'].mask(df['price'] < 0, df['price'].median())"}
{"prompt": "Question: Find sales where employee_id and product_id are the same.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['employee_id'] == df['product_id']]"}
{"prompt": "Question: Calculate the total revenue per product on weekends.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.dayofweek >= 5].groupby('product_id').apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Find the number of sales per employee in 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].str.contains('2023')].groupby('employee_id').size()"}
{"prompt": "Question: Filter sales where quantity is in the top 5%.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] >= df['quantity'].quantile(0.95)]"}
{"prompt": "Question: Calculate the average quantity sold per employee on weekends.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.dayofweek >= 5].groupby('employee_id')['quantity'].mean()"}
{"prompt": "Question: Find the total price for sales in the last 7 days.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'] >= df['sale_date'].max() - pd.Timedelta(days=7)]['price'].sum()"}
{"prompt": "Question: Drop rows where both quantity and price are missing.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.dropna(subset=['quantity', 'price'], how='all')"}
{"prompt": "Question: Find employees with total revenue above 1000.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id').filter(lambda x: (x['quantity'] * x['price']).sum() > 1000)"}
{"prompt": "Question: Calculate the cumulative quantity sold per product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id')['quantity'].cumsum()"}
{"prompt": "Question: Find sales where price is exactly 50.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['price'] == 50]"}
{"prompt": "Question: Group by employee and calculate the minimum sale date.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id')['sale_date'].min()"}
{"prompt": "Question: Find products with no sales in 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[~df['sale_date'].str.contains('2023')]['product_id'].unique()"}
{"prompt": "Question: Calculate the total revenue for sales on Mondays.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.dayofweek == 0].apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Find the average quantity sold per product in 2022.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].str.contains('2022')].groupby('product_id')['quantity'].mean()"}
{"prompt": "Question: Filter sales where revenue is below the median revenue.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] * df['price'] < (df['quantity'] * df['price']).median()]"}
{"prompt": "Question: Calculate the total quantity sold per employee in Q2 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].between('2023-04-01', '2023-06-30')].groupby('employee_id')['quantity'].sum()"}
{"prompt": "Question: Find sales where product_id ends with 'A'.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['product_id'].str.endswith('A')]"}
{"prompt": "Question: Calculate the standard deviation of quantity per product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id')['quantity'].std()"}
{"prompt": "Question: Find the top 5 products by total revenue.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id').apply(lambda x: (x['quantity'] * x['price']).sum()).nlargest(5)"}
{"prompt": "Question: Filter sales where sale_date is in 2021.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].str.contains('2021')]"}
{"prompt": "Question: Calculate the total quantity sold per employee on Fridays.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.dayofweek == 4].groupby('employee_id')['quantity'].sum()"}
{"prompt": "Question: Replace quantities above 100 with 100.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['quantity'].clip(upper=100)"}
{"prompt": "Question: Find sales with the highest revenue per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.loc[df.groupby('employee_id').apply(lambda x: (x['quantity'] * x['price']).idxmax())]"}
{"prompt": "Question: Calculate the total revenue for sales in the last 90 days.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'] >= df['sale_date'].max() - pd.Timedelta(days=90)].apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Find products with sales on more than 10 dates.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id').filter(lambda x: x['sale_date'].nunique() > 10)"}
{"prompt": "Question: Calculate the median revenue per sale date.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('sale_date').apply(lambda x: (x['quantity'] * x['price']).median())"}
{"prompt": "Question: Filter sales where quantity is a multiple of 5.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] % 5 == 0]"}
{"prompt": "Question: Find the total revenue for each employee in Q3 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].between('2023-07-01', '2023-09-30')].groupby('employee_id').apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Calculate the average price for sales with quantity above 10.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] > 10]['price'].mean()"}
{"prompt": "Question: Find sales where price is below the 10th percentile.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['price'] < df['price'].quantile(0.1)]"}
{"prompt": "Question: Group by product and calculate the total quantity sold on weekends.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.dayofweek >= 5].groupby('product_id')['quantity'].sum()"}
{"prompt": "Question: Find employees with sales in both 2022 and 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].str.contains('2022|2023')].groupby('employee_id').filter(lambda x: x['sale_date'].str.contains('2022').any() and x['sale_date'].str.contains('2023').any())"}
{"prompt": "Question: Calculate the total revenue for sales on the 15th of any month.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.day == 15].apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Find products with average revenue above 500.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id').filter(lambda x: (x['quantity'] * x['price']).mean() > 500)"}
{"prompt": "Question: Filter sales where employee_id contains 'A'.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['employee_id'].str.contains('A')]"}
{"prompt": "Question: Calculate the total quantity sold per employee in Q4 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].between('2023-10-01', '2023-12-31')].groupby('employee_id')['quantity'].sum()"}
{"prompt": "Question: Find the average revenue per employee on Fridays.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.dayofweek == 4].groupby('employee_id').apply(lambda x: (x['quantity'] * x['price']).mean())"}
{"prompt": "Question: Replace missing sale_dates with the earliest sale date.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df['sale_date'].fillna(df['sale_date'].min())"}
{"prompt": "Question: Find sales where revenue is in the top 1%.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] * df['price'] >= (df['quantity'] * df['price']).quantile(0.99)]"}
{"prompt": "Question: Calculate the total quantity sold per product in Q1 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].between('2023-01-01', '2023-03-31')].groupby('product_id')['quantity'].sum()"}
{"prompt": "Question: Find employees with no sales on weekends.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[~df['sale_date'].dt.dayofweek.isin([5, 6])]['employee_id'].unique()"}
{"prompt": "Question: Calculate the average quantity sold per sale date in 2022.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].str.contains('2022')].groupby('sale_date')['quantity'].mean()"}
{"prompt": "Question: Filter sales where price is a multiple of 10.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['price'] % 10 == 0]"}
{"prompt": "Question: Find the total revenue for sales in the first half of 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].between('2023-01-01', '2023-06-30')].apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Calculate the median quantity sold per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('employee_id')['quantity'].median()"}
{"prompt": "Question: Find sales where quantity is above the 75th percentile.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] > df['quantity'].quantile(0.75)]"}
{"prompt": "Question: Group by product and calculate the total revenue on Mondays.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.dayofweek == 0].groupby('product_id').apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Find employees with sales in every quarter of 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].str.contains('2023')].groupby('employee_id').filter(lambda x: all(x['sale_date'].dt.quarter.isin([1, 2, 3, 4])))"}
{"prompt": "Question: Calculate the total quantity sold on the last day of each month.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.is_month_end]['quantity'].sum()"}
{"prompt": "Question: Find products with total quantity sold below 100.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df.groupby('product_id').filter(lambda x: x['quantity'].sum() < 100)"}
{"prompt": "Question: Filter sales where employee_id is not in a specific list.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[~df['employee_id'].isin(['E1', 'E2', 'E3'])]"}
{"prompt": "Question: Calculate the total revenue per employee in the second half of 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].between('2023-07-01', '2023-12-31')].groupby('employee_id').apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Find sales where price is above the mean price for each product.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['price'] > df.groupby('product_id')['price'].transform('mean')]"}
{"prompt": "Question: Calculate the total quantity sold per product on the first day of each month.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].dt.is_month_start].groupby('product_id')['quantity'].sum()"}
{"prompt": "Question: Find employees with sales on the last day of 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'] == '2023-12-31']['employee_id'].unique()"}
{"prompt": "Question: Calculate the average revenue per product in Q2 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].between('2023-04-01', '2023-06-30')].groupby('product_id').apply(lambda x: (x['quantity'] * x['price']).mean())"}
{"prompt": "Question: Filter sales where quantity is not a multiple of 3.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['quantity'] % 3 != 0]"}
{"prompt": "Question: Find the total revenue for sales in the last week of 2023.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].between('2023-12-25', '2023-12-31')].apply(lambda x: (x['quantity'] * x['price']).sum())"}
{"prompt": "Question: Calculate the median price per product in 2022.\nColumns: employee_id, product_id, quantity, price, sale_date\nAnswer:", "completion": "df[df['sale_date'].str.contains('2022')].groupby('product_id')['price'].median()"}
{"prompt": "Question: Pivot table showing total quantity for each employee per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.pivot_table(index='employee_id', columns='product_id', values='quantity', aggfunc='sum')"}
{"prompt": "Question: Add a column 'high_price' which is True if price > 100.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['high_price'] = df['price'] > 100"}
{"prompt": "Question: Filter rows where product_id is 'P123'.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['product_id'] == 'P123']"}
{"prompt": "Question: Find the minimum quantity sold per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['quantity'].min()"}
{"prompt": "Question: Sort the dataset by quantity ascending and then price descending.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.sort_values(['quantity', 'price'], ascending=[True, False])"}
{"prompt": "Question: Remove duplicate rows based on employee_id and product_id.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.drop_duplicates(subset=['employee_id', 'product_id'])"}
{"prompt": "Question: Create a column 'month' from sale_date.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['month'] = df['sale_date'].dt.month"}
{"prompt": "Question: Count number of sales per month.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby(df['sale_date'].dt.month).size()"}
{"prompt": "Question: Filter rows where price is not null.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['price'].notnull()]"}
{"prompt": "Question: Get summary statistics for quantity and price.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[['quantity', 'price']].describe()"}
{"prompt": "Question: Merge df with df_suppliers on product_id using left join.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.merge(df_suppliers, on='product_id', how='left')"}
{"prompt": "Question: Filter rows where employee_id is in [101, 102, 103].\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['employee_id'].isin([101, 102, 103])]"}
{"prompt": "Question: Round the price column to 2 decimal places.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['price'] = df['price'].round(2)"}
{"prompt": "Question: Replace missing quantities with 0.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['quantity'].fillna(0, inplace=True)"}
{"prompt": "Question: Create a column 'revenue_category' based on total_cost > 500.\nColumns: employee_id, product_id, quantity, price, sale_date, total_cost\n\nAnswer:", "completion": "df['revenue_category'] = df['total_cost'].apply(lambda x: 'High' if x > 500 else 'Low')"}
{"prompt": "Question: Find the top 3 employees by total revenue.\nColumns: employee_id, product_id, quantity, price, sale_date, total_cost\n\nAnswer:", "completion": "df.groupby('employee_id')['total_cost'].sum().nlargest(3)"}
{"prompt": "Question: Select rows where sale_date is after 2024-01-01.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['sale_date'] > '2024-01-01']"}
{"prompt": "Question: Calculate cumulative sum of quantity for each employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.sort_values('sale_date').groupby('employee_id')['quantity'].cumsum()"}
{"prompt": "Question: Filter rows where total_cost is between 100 and 500.\nColumns: employee_id, product_id, quantity, price, sale_date, total_cost\n\nAnswer:", "completion": "df[df['total_cost'].between(100, 500)]"}
{"prompt": "Question: Count number of unique employees per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['employee_id'].nunique()"}
{"prompt": "Question: Find average price for each month.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby(df['sale_date'].dt.month)['price'].mean()"}
{"prompt": "Question: Create a flag column 'big_sale' if quantity > 20.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['big_sale'] = df['quantity'] > 20"}
{"prompt": "Question: Select rows where employee_id is not 105.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['employee_id'] != 105]"}
{"prompt": "Question: Create a column 'quarter' based on sale_date.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['quarter'] = df['sale_date'].dt.quarter"}
{"prompt": "Question: Filter rows where quarter is 1.\nColumns: employee_id, product_id, quantity, price, sale_date, quarter\n\nAnswer:", "completion": "df[df['quarter'] == 1]"}
{"prompt": "Question: Get mean and median price per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['price'].agg(['mean', 'median'])"}
{"prompt": "Question: Get top 5 most expensive products.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.nlargest(5, 'price')"}
{"prompt": "Question: Filter rows where employee_id is 101 and quantity > 10.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[(df['employee_id']==101) & (df['quantity']>10)]"}
{"prompt": "Question: Find total amount spent by each customer.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id')['amount'].sum()"}
{"prompt": "Question: Get the average amount per order category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['amount'].mean()"}
{"prompt": "Question: Filter orders with amount greater than 50.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] > 50]"}
{"prompt": "Question: Sort orders by amount descending.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.sort_values('amount', ascending=False)"}
{"prompt": "Question: Count orders per customer.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id').size()"}
{"prompt": "Question: Select customer_id and order_date columns.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[['customer_id', 'order_date']]"}
{"prompt": "Question: Find maximum amount per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['amount'].max()"}
{"prompt": "Question: Filter orders after 2024-01-01.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'] > '2024-01-01']"}
{"prompt": "Question: Find earliest order date per customer.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id')['order_date'].min()"}
{"prompt": "Question: Get unique product categories.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df['product_category'].unique()"}
{"prompt": "Question: Count orders where amount above 100.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] > 100].shape[0]"}
{"prompt": "Question: Pivot total amount by customer and category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.pivot_table(values='amount', index='customer_id', columns='product_category', aggfunc='sum')"}
{"prompt": "Question: Fill missing amounts with mean amount.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df['amount'].fillna(df['amount'].mean())"}
{"prompt": "Question: Find customers with total spend above 500.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id').filter(lambda x: x['amount'].sum() > 500)"}
{"prompt": "Question: Get top 5 orders by amount.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.nlargest(5, 'amount')"}
{"prompt": "Question: Calculate median amount per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['amount'].median()"}
{"prompt": "Question: Sort by order_date ascending.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.sort_values('order_date')"}
{"prompt": "Question: Find total amount per order_date.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('order_date')['amount'].sum()"}
{"prompt": "Question: Select rows where category in list.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['product_category'].isin(['Electronics', 'Books'])]"}
{"prompt": "Question: Calculate cumulative amount per customer.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id')['amount'].cumsum()"}
{"prompt": "Question: Drop rows with missing order_date.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.dropna(subset=['order_date'])"}
{"prompt": "Question: Get last order for each customer.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id').last()"}
{"prompt": "Question: Calculate average amount per order.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df['amount'].mean()"}
{"prompt": "Question: Filter amounts between 20 and 80.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'].between(20, 80)]"}
{"prompt": "Question: Find total amount per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['amount'].sum()"}
{"prompt": "Question: Replace negative amounts with 0.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df['amount'].clip(lower=0)"}
{"prompt": "Question: Find orders below average amount.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] < df['amount'].mean()]"}
{"prompt": "Question: Group by order_date count unique categories.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('order_date')['product_category'].nunique()"}
{"prompt": "Question: Find latest order date per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['order_date'].max()"}
{"prompt": "Question: Calculate std dev of amount per customer.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id')['amount'].std()"}
{"prompt": "Question: Filter non-null amounts.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'].notnull()]"}
{"prompt": "Question: Top 3 customers by total amount.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id')['amount'].sum().nlargest(3)"}
{"prompt": "Question: Select specific customer IDs.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['customer_id'].isin(['C1', 'C2'])]"}
{"prompt": "Question: Find min amount per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['amount'].min()"}
{"prompt": "Question: Drop duplicates by customer and date.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.drop_duplicates(subset=['customer_id', 'order_date'])"}
{"prompt": "Question: Total amount in 2024.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].str.contains('2024')]['amount'].sum()"}
{"prompt": "Question: Orders with max amount.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] == df['amount'].max()]"}
{"prompt": "Question: Pivot average amount by customer category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.pivot_table(values='amount', index='customer_id', columns='product_category', aggfunc='mean')"}
{"prompt": "Question: Fill missing amounts with 0.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df['amount'].fillna(0)"}
{"prompt": "Question: Customers with avg amount > 50.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id').filter(lambda x: x['amount'].mean() > 50)"}
{"prompt": "Question: Sort by amount and date.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.sort_values(['amount', 'order_date'])"}
{"prompt": "Question: Count orders per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category').size()"}
{"prompt": "Question: Orders in top 10% amount.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] >= df['amount'].quantile(0.9)]"}
{"prompt": "Question: Total amount per customer in 2024.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].str.contains('2024')].groupby('customer_id')['amount'].sum()"}
{"prompt": "Question: Average amount per customer.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id')['amount'].mean()"}
{"prompt": "Question: Filter amounts > median.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] > df['amount'].median()]"}
{"prompt": "Question: Most recent order date per customer.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id')['order_date'].max()"}
{"prompt": "Question: Total amount in Q1 2024.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].between('2024-01-01', '2024-03-31')]['amount'].sum()"}
{"prompt": "Question: Categories with total > 1000.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category').filter(lambda x: x['amount'].sum() > 1000)"}
{"prompt": "Question: Orders on even days.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].dt.day % 2 == 0]"}
{"prompt": "Question: Total amount per category in 2023.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].str.contains('2023')].groupby('product_category')['amount'].sum()"}
{"prompt": "Question: Variance of amount per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['amount'].var()"}
{"prompt": "Question: Bottom 5 orders by amount.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.nsmallest(5, 'amount')"}
{"prompt": "Question: Create revenue column.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df['revenue'] = df['amount']"}
{"prompt": "Question: Filter customer_id starts with 'C1'.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['customer_id'].str.startswith('C1')]"}
{"prompt": "Question: Total amount per customer on Mondays.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].dt.dayofweek == 0].groupby('customer_id')['amount'].sum()"}
{"prompt": "Question: Average amount per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['amount'].mean()"}
{"prompt": "Question: Orders with min amount.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] == df['amount'].min()]"}
{"prompt": "Question: Sort date desc, customer asc.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.sort_values(['order_date', 'customer_id'], ascending=[False, True])"}
{"prompt": "Question: Unique customers per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['customer_id'].nunique()"}
{"prompt": "Question: Amounts > Q1.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] > df['amount'].quantile(0.25)]"}
{"prompt": "Question: Cumulative amount per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['amount'].cumsum()"}
{"prompt": "Question: Cap amounts at 1000.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df['amount'].clip(upper=1000)"}
{"prompt": "Question: Top 10 orders by amount.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.nlargest(10, 'amount')"}
{"prompt": "Question: Max amount per date.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('order_date')['amount'].max()"}
{"prompt": "Question: Non-na category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['product_category'].notna()]"}
{"prompt": "Question: Customers >5 orders.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id').filter(lambda x: len(x) > 5)"}
{"prompt": "Question: Total amount last 30 days.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'] >= df['order_date'].max() - pd.Timedelta(days=30)]['amount'].sum()"}
{"prompt": "Question: Avg amount per date.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('order_date')['amount'].mean()"}
{"prompt": "Question: Orders on Friday.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].dt.dayofweek == 4]"}
{"prompt": "Question: Total amount >20.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] > 20]['amount'].sum()"}
{"prompt": "Question: First order per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category').first()"}
{"prompt": "Question: Drop zero amounts.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] != 0]"}
{"prompt": "Question: Categories avg >10.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category').filter(lambda x: x['amount'].mean() > 10)"}
{"prompt": "Question: Median amount per customer.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id')['amount'].median()"}
{"prompt": "Question: Q1 orders.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].dt.quarter == 1]"}
{"prompt": "Question: Total per customer Jan 2024.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].str.contains('2024-01')].groupby('customer_id')['amount'].sum()"}
{"prompt": "Question: Negative amounts to median.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df['amount'].mask(df['amount'] < 0, df['amount'].median())"}
{"prompt": "Question: Total amount weekends.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].dt.dayofweek >= 5].groupby('product_category')['amount'].sum()"}
{"prompt": "Question: Orders per customer 2024.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].str.contains('2024')].groupby('customer_id').size()"}
{"prompt": "Question: Amounts top 5%.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] >= df['amount'].quantile(0.95)]"}
{"prompt": "Question: Avg amount per customer weekends.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].dt.dayofweek >= 5].groupby('customer_id')['amount'].mean()"}
{"prompt": "Question: Total amount last 7 days.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'] >= df['order_date'].max() - pd.Timedelta(days=7)]['amount'].sum()"}
{"prompt": "Question: Drop missing amount and category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.dropna(subset=['amount', 'product_category'], how='all')"}
{"prompt": "Question: Customers total >1000.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id').filter(lambda x: x['amount'].sum() > 1000)"}
{"prompt": "Question: Cumulative per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['amount'].cumsum()"}
{"prompt": "Question: Amounts ==50.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] == 50]"}
{"prompt": "Question: Earliest date per customer.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('customer_id')['order_date'].min()"}
{"prompt": "Question: Categories no 2024.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[~df['order_date'].str.contains('2024')]['product_category'].unique()"}
{"prompt": "Question: Total on Mondays.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].dt.dayofweek == 0]['amount'].sum()"}
{"prompt": "Question: Avg per category 2023.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].str.contains('2023')].groupby('product_category')['amount'].mean()"}
{"prompt": "Question: Below median amount.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['amount'] < df['amount'].median()]"}
{"prompt": "Question: Total per customer Q2 2024.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].between('2024-04-01', '2024-06-30')].groupby('customer_id')['amount'].sum()"}
{"prompt": "Question: Category ends with 's'.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['product_category'].str.endswith('s')]"}
{"prompt": "Question: Std dev per category.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['amount'].std()"}
{"prompt": "Question: Top 5 categories by total.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category')['amount'].sum().nlargest(5)"}
{"prompt": "Question: Orders in 2023.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].str.contains('2023')]"}
{"prompt": "Question: Total per customer Fridays.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'].dt.dayofweek == 4].groupby('customer_id')['amount'].sum()"}
{"prompt": "Question: Cap quantity at 100.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df['amount'].clip(upper=100)"}
{"prompt": "Question: Highest amount per customer.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.loc[df.groupby('customer_id')['amount'].idxmax()]"}
{"prompt": "Question: Total last 90 days.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df[df['order_date'] >= df['order_date'].max() - pd.Timedelta(days=90)]['amount'].sum()"}
{"prompt": "Question: Categories >10 dates.\nColumns: customer_id, order_id, order_date, amount, product_category\nAnswer:", "completion": "df.groupby('product_category').filter(lambda x: x['order_date'].nunique() > 10)"}
{"prompt": "Question: Find the median quantity sold per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('employee_id')['quantity'].median()"}
{"prompt": "Question: Find products with sales in more than 3 months.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['sale_date'].nunique().loc[lambda x: x>3]"}
{"prompt": "Question: Create a column 'sale_weekday' showing the day of the week.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['sale_weekday'] = df['sale_date'].dt.day_name()"}
{"prompt": "Question: Filter rows where product_id starts with 'A'.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['product_id'].str.startswith('A')]"}
{"prompt": "Question: Replace missing sale_date with today.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['sale_date'].fillna(pd.Timestamp.today(), inplace=True)"}
{"prompt": "Question: Calculate total quantity per week.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby(df['sale_date'].dt.isocalendar().week)['quantity'].sum()"}
{"prompt": "Question: Find employees with exactly 5 sales in a month.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby(['employee_id', df['sale_date'].dt.month]).size().loc[lambda x: x==5]"}
{"prompt": "Question: Count total sales transactions per week.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby(df['sale_date'].dt.isocalendar().week).size()"}
{"prompt": "Question: Filter rows where price is between 50 and 100.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['price'].between(50, 100)]"}
{"prompt": "Question: Count number of sales per weekday.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby(df['sale_date'].dt.day_name()).size()"}
{"prompt": "Question: Create a column 'avg_price_per_product' showing product's average price.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['avg_price_per_product'] = df.groupby('product_id')['price'].transform('mean')"}
{"prompt": "Question: Filter rows where quantity is above the 75th percentile.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['quantity']>df['quantity'].quantile(0.75)]"}
{"prompt": "Question: Rank products by total quantity sold.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['quantity'].sum().rank(ascending=False)"}
{"prompt": "Question: Calculate difference in quantity sold between consecutive days for each employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.sort_values('sale_date').groupby('employee_id')['quantity'].diff()"}
{"prompt": "Question: Create a column 'is_peak_hour' where sale_time between 18:00 and 21:00 is True.\nColumns: employee_id, product_id, quantity, price, sale_date, sale_time\n\nAnswer:", "completion": "df['is_peak_hour'] = df['sale_time'].between('18:00','21:00')"}
{"prompt": "Question: Filter rows where product_id contains 'X' and quantity > 10.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['product_id'].str.contains('X') & (df['quantity']>10)]"}
{"prompt": "Question: Create a column 'next_sale_date' showing next sale date per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.sort_values('sale_date').groupby('employee_id')['sale_date'].shift(-1)"}
{"prompt": "Question: Calculate rolling sum of quantity over last 3 sales per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('employee_id')['quantity'].rolling(3).sum().reset_index(level=0, drop=True)"}
{"prompt": "Question: Flag rows where price is above the 90th percentile.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['high_price_flag'] = df['price']>df['price'].quantile(0.9)"}
{"prompt": "Question: Filter products sold in exactly 2 months.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['sale_date'].nunique().loc[lambda x: x==2]"}
{"prompt": "Question: Create a column 'days_since_last_sale' per employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.sort_values('sale_date').groupby('employee_id')['sale_date'].diff().dt.days"}
{"prompt": "Question: What is the total revenue generated from all sales?\nColumns: sale_id, product_id, quantity, unit_price, sale_date\n\nAnswer:", "completion": " (df['quantity'] * df['unit_price']).sum()"}
{"prompt": "Question: List all sales that occurred after January 15, 2023.\nColumns: sale_id, product_id, quantity, unit_price, sale_date\n\nAnswer:", "completion": " df[df['sale_date'] > '2023-01-15']"}
{"prompt": "Question: Find the top 5 products with the highest total quantity sold.\nColumns: sale_id, product_id, quantity, unit_price, sale_date\n\nAnswer:", "completion": " df.groupby('product_id')['quantity'].sum().nlargest(5)"}
{"prompt": "Question: Calculate the average unit price for each product category.\nColumns: product_id, product_name, category, unit_price\n\nAnswer:", "completion": " df.groupby('category')['unit_price'].mean()"}
{"prompt": "Question: Count the number of unique customers who made a purchase.\nColumns: sale_id, customer_id, amount, date\n\nAnswer:", "completion": " df['customer_id'].nunique()"}
{"prompt": "Question: Show the daily total sales amount.\nColumns: sale_id, amount, date\n\nAnswer:", "completion": " df.groupby('date')['amount'].sum()"}
{"prompt": "Question: Filter the records where the transaction amount is greater than 1000.\nColumns: transaction_id, account_id, amount, type\n\nAnswer:", "completion": " df[df['amount'] > 1000]"}
{"prompt": "Question: Get the most recent sale for each customer.\nColumns: sale_id, customer_id, amount, date\n\nAnswer:", "completion": " df.loc[df.groupby('customer_id')['date'].idxmax()]"}
{"prompt": "Question: List all products where the units_sold value is missing.\nColumns: product_id, product_name, units_sold\n\nAnswer:", "completion": " df[df['units_sold'].isna()]"}
{"prompt": "Question: Find the employee with the highest total sales amount.\nColumns: employee_id, sale_amount, sale_date\n\nAnswer:", "completion": " df.groupby('employee_id')['sale_amount'].sum().idxmax()"}
{"prompt": "Question: Calculate the median salary for each department.\nColumns: employee_id, name, department, salary\n\nAnswer:", "completion": " df.groupby('department')['salary'].median()"}
{"prompt": "Question: Create a pivot table showing total sales by region and product category.\nColumns: sale_id, region, category, sales_amount\n\nAnswer:", "completion": " df.pivot_table(values='sales_amount', index='region', columns='category', aggfunc='sum')"}
{"prompt": "Question: Fill missing values in the 'price' column with the column's mean value.\nColumns: product_id, name, price\n\nAnswer:", "completion": " df['price'].fillna(df['price'].mean(), inplace=True)"}
{"prompt": "Question: Select only the 'name' and 'email' columns for all customers.\nColumns: customer_id, name, email, phone, address\n\nAnswer:", "completion": " df[['name', 'email']]"}
{"prompt": "Question: Find the correlation between age and income in the customer data.\nColumns: customer_id, age, income, city\n\nAnswer:", "completion": " df['age'].corr(df['income'])"}
{"prompt": "Question: Add a rank for employees by their sales performance within their department.\nColumns: employee_id, department, sales\n\nAnswer:", "completion": " df['rank'] = df.groupby('department')['sales'].rank(ascending=False)"}
{"prompt": "Question: Merge the orders dataframe with the customers dataframe on the customer_id key.\nColumns: order_id, customer_id, amount; customer_id, name, city\n\nAnswer:", "completion": " pd.merge(orders_df, customers_df, on='customer_id')"}
{"prompt": "Question: Drop all duplicate rows based on the 'email' column.\nColumns: user_id, name, email, signup_date\n\nAnswer:", "completion": " df.drop_duplicates(subset=['email'])"}
{"prompt": "Question: Calculate the 90th percentile of transaction values.\nColumns: transaction_id, value, date\n\nAnswer:", "completion": " df['value'].quantile(0.9)"}
{"prompt": "Question: Find all orders with a status of 'shipped'.\nColumns: order_id, customer_id, status, order_date\n\nAnswer:", "completion": " df[df['status'] == 'shipped']"}
{"prompt": "Question: Calculate the cumulative sum of sales over time.\nColumns: sale_id, amount, date\n\nAnswer:", "completion": " df['cumulative_sales'] = df['amount'].cumsum()"}
{"prompt": "Question: Get the standard deviation of product prices.\nColumns: product_id, name, price\n\nAnswer:", "completion": " df['price'].std()"}
{"prompt": "Question: Find the mode of the department column.\nColumns: employee_id, name, department\n\nAnswer:", "completion": " df['department'].mode()"}
{"prompt": "Question: List all employees who joined in the year 2022.\nColumns: employee_id, name, join_date, department\n\nAnswer:", "completion": " df[df['join_date'].dt.year == 2022]"}
{"prompt": "Question: Calculate the total sales for each month.\nColumns: sale_id, amount, date\n\nAnswer:", "completion": " df.groupby(df['date'].dt.to_period('M'))['amount'].sum()"}
{"prompt": "Question: Find products with a price between $50 and $100.\nColumns: product_id, name, price, category\n\nAnswer:", "completion": " df[df['price'].between(50, 100)]"}
{"prompt": "Question: Count the number of sales per product category.\nColumns: sale_id, category, amount, date\n\nAnswer:", "completion": " df['category'].value_counts()"}
{"prompt": "Question: Get the average transaction value for each day of the week.\nColumns: transaction_id, amount, date\n\nAnswer:", "completion": " df.groupby(df['date'].dt.dayofweek)['amount'].mean()"}
{"prompt": "Question: Find the customer with the highest average order value.\nColumns: order_id, customer_id, amount, date\n\nAnswer:", "completion": " df.groupby('customer_id')['amount'].mean().idxmax()"}
{"prompt": "Question: Replace all negative values in the balance column with 0.\nColumns: account_id, balance, last_updated\n\nAnswer:", "completion": " df['balance'] = df['balance'].clip(lower=0)"}
{"prompt": "Question: Calculate the difference between each sale amount and the overall average.\nColumns: sale_id, amount, date\n\nAnswer:", "completion": " df['diff_from_mean'] = df['amount'] - df['amount'].mean()"}
{"prompt": "Question: Find the product with the most price fluctuations.\nColumns: product_id, date, price\n\nAnswer:", "completion": " df.groupby('product_id')['price'].std().idxmax()"}
{"prompt": "Question: Get the earliest and latest date in the dataset.\nColumns: event_id, event_name, date\n\nAnswer:", "completion": " df['date'].agg(['min', 'max'])"}
{"prompt": "Question: Calculate the rolling 7-day average of sales.\nColumns: date, sales_amount\n\nAnswer:", "completion": " df['rolling_avg'] = df['sales_amount'].rolling(window=7).mean()"}
{"prompt": "Question: Find customers who have made more than 5 purchases.\nColumns: customer_id, order_id, amount, date\n\nAnswer:", "completion": " df.groupby('customer_id').filter(lambda x: len(x) > 5)"}
{"prompt": "Question: Normalize the age values to a 0-1 scale.\nColumns: user_id, name, age\n\nAnswer:", "completion": " df['normalized_age'] = (df['age'] - df['age'].min()) / (df['age'].max() - df['age'].min())"}
{"prompt": "Question: Create a new column that categorizes sales as 'High' or 'Low' based on a $500 threshold.\nColumns: sale_id, amount, date\n\nAnswer:", "completion": " df['sale_category'] = np.where(df['amount'] > 500, 'High', 'Low')"}
{"prompt": "Question: Calculate the percentage of total sales for each product.\nColumns: product_id, sales_amount\n\nAnswer:", "completion": " df['sales_pct'] = df['sales_amount'] / df['sales_amount'].sum() * 100"}
{"prompt": "Question: Find the busiest hour of the day for transactions.\nColumns: transaction_id, amount, timestamp\n\nAnswer:", "completion": " df['timestamp'].dt.hour.value_counts().idxmax()"}
{"prompt": "Question: Get the total number of null values in each column.\nColumns: col1, col2, col3, col4\n\nAnswer:", "completion": " df.isnull().sum()"}
{"prompt": "Question: Calculate the exponential moving average of stock prices with a span of 10 days.\nColumns: date, stock_price\n\nAnswer:", "completion": " df['ema'] = df['stock_price'].ewm(span=10).mean()"}
{"prompt": "Question: Find products that have been sold in all regions.\nColumns: product_id, region, sales\n\nAnswer:", "completion": " df.groupby('product_id')['region'].nunique().loc[lambda x: x == df['region'].nunique()]"}
{"prompt": "Question: Calculate the week-over-week growth percentage in user signups.\nColumns: date, signups\n\nAnswer:", "completion": " df['wow_growth'] = df['signups'].pct_change(periods=7) * 100"}
{"prompt": "Question: Find the most common city for customers in each state.\nColumns: customer_id, city, state\n\nAnswer:", "completion": " df.groupby('state')['city'].agg(lambda x: x.value_counts().index[0])"}
{"prompt": "Question: Calculate the interquartile range of product prices.\nColumns: product_id, price\n\nAnswer:", "completion": " df['price'].quantile(0.75) - df['price'].quantile(0.25)"}
{"prompt": "Question: Get the last 10 records in the dataset.\nColumns: id, value, timestamp\n\nAnswer:", "completion": " df.tail(10)"}
{"prompt": "Question: Find the average time between orders for each customer.\nColumns: customer_id, order_date\n\nAnswer:", "completion": " df.groupby('customer_id')['order_date'].apply(lambda x: x.sort_values().diff().mean())"}
{"prompt": "Question: Create a boolean column indicating whether a product is on sale (price reduced by more than 20%).\nColumns: product_id, current_price, original_price\n\nAnswer:", "completion": " df['on_sale'] = (df['original_price'] - df['current_price']) / df['original_price'] > 0.2"}
{"prompt": "Question: Calculate the median absolute deviation of transaction amounts.\nColumns: transaction_id, amount\n\nAnswer:", "completion": " (df['amount'] - df['amount'].median()).abs().median()"}
{"prompt": "Question: Find the percentage of customers who made repeat purchases.\nColumns: customer_id, order_id\n\nAnswer:", "completion": " (df['customer_id'].value_counts() > 1).mean() * 100"}
{"prompt": "Question: Get the most frequently occurring value in each column.\nColumns: col1, col2, col3\n\nAnswer:", "completion": " df.mode().iloc[0]"}
{"prompt": "Question: Calculate the compound annual growth rate of revenue over 5 years.\nColumns: year, revenue\n\nAnswer:", "completion": " (df['revenue'].iloc[-1] / df['revenue'].iloc[0]) ** (1/5) - 1"}
{"prompt": "Question: Find customers whose last purchase was more than 90 days ago.\nColumns: customer_id, last_purchase_date\n\nAnswer:", "completion": " df[df['last_purchase_date'] < pd.Timestamp.now() - pd.Timedelta(days=90)]"}
{"prompt": "Question: Calculate the percentage change in sales from the previous month.\nColumns: month, sales\n\nAnswer:", "completion": " df['sales'].pct_change() * 100"}
{"prompt": "Question: Find the pairwise correlation between all numerical columns.\nColumns: col1, col2, col3, col4\n\nAnswer:", "completion": " df.corr()"}
{"prompt": "Question: Get the unique combinations of region and product category.\nColumns: region, category, sales\n\nAnswer:", "completion": " df[['region', 'category']].drop_duplicates()"}
{"prompt": "Question: Calculate the 25th, 50th, and 75th percentiles of customer age.\nColumns: customer_id, age\n\nAnswer:", "completion": " df['age'].quantile([0.25, 0.5, 0.75])"}
{"prompt": "Question: Find the average number of products per order.\nColumns: order_id, product_id, quantity\n\nAnswer:", "completion": " df.groupby('order_id')['product_id'].count().mean()"}
{"prompt": "Question: Create a new column that extracts the domain from email addresses.\nColumns: user_id, email\n\nAnswer:", "completion": " df['domain'] = df['email'].str.split('@').str[1]"}
{"prompt": "Question: Calculate the ratio of sales to returns for each product.\nColumns: product_id, transaction_type, amount\n\nAnswer:", "completion": " sales = df[df['transaction_type'] == 'sale'].groupby('product_id')['amount'].sum(); returns = df[df['transaction_type'] == 'return'].groupby('product_id')['amount'].sum(); (sales / returns.abs())"}
{"prompt": "Question: Find the most common first name among customers.\nColumns: customer_id, first_name, last_name\n\nAnswer:", "completion": " df['first_name'].value_counts().idxmax()"}
{"prompt": "Question: Calculate the average time spent on website by browser type.\nColumns: session_id, browser, time_spent\n\nAnswer:", "completion": " df.groupby('browser')['time_spent'].mean()"}
{"prompt": "Question: Get the cumulative count of orders over time.\nColumns: order_id, date\n\nAnswer:", "completion": " df['cumulative_orders'] = range(1, len(df)+1)"}
{"prompt": "Question: Find products that have never been returned.\nColumns: product_id, transaction_type\n\nAnswer:", "completion": " returned_products = df[df['transaction_type'] == 'return']['product_id'].unique(); df[~df['product_id'].isin(returned_products)]"}
{"prompt": "Question: Calculate the average order value for first-time vs repeat customers.\nColumns: order_id, customer_id, amount, is_first_order\n\nAnswer:", "completion": " df.groupby('is_first_order')['amount'].mean()"}
{"prompt": "Question: Find the day with the highest number of user registrations.\nColumns: user_id, registration_date\n\nAnswer:", "completion": " df['registration_date'].value_counts().idxmax()"}
{"prompt": "Question: Calculate the retention rate from week 1 to week 2.\nColumns: user_id, week, active\n\nAnswer:", "completion": " week1_users = df[df['week'] == 1]['user_id']; week2_users = df[df['week'] == 2]['user_id']; len(week2_users.isin(week1_users)) / len(week1_users) * 100"}
{"prompt": "Question: Get the distribution of order amounts in $100 buckets.\nColumns: order_id, amount\n\nAnswer:", "completion": " pd.cut(df['amount'], bins=range(0, int(df['amount'].max())+100, 100)).value_counts()"}
{"prompt": "Question: Find the correlation between temperature and sales.\nColumns: date, temperature, sales\n\nAnswer:", "completion": " df['temperature'].corr(df['sales'])"}
{"prompt": "Question: Calculate the average customer lifetime value.\nColumns: customer_id, total_revenue, tenure\n\nAnswer:", "completion": " df['total_revenue'].sum() / df['customer_id'].nunique()"}
{"prompt": "Question: Get the most popular product category for each age group.\nColumns: customer_id, age_group, category, purchases\n\nAnswer:", "completion": " df.groupby(['age_group', 'category'])['purchases'].sum().groupby('age_group').idxmax()"}
{"prompt": "Question: Calculate the percentage of orders that include a specific product.\nColumns: order_id, product_id\n\nAnswer:", "completion": " (df['product_id'] == 'specific_product').mean() * 100"}
{"prompt": "Question: Find the average number of days between customer purchases.\nColumns: customer_id, purchase_date\n\nAnswer:", "completion": " df.groupby('customer_id')['purchase_date'].apply(lambda x: x.sort_values().diff().mean())"}
{"prompt": "Question: Get the top 3 selling products in each region.\nColumns: region, product_id, sales\n\nAnswer:", "completion": " df.groupby(['region', 'product_id'])['sales'].sum().groupby('region').nlargest(3)"}
{"prompt": "Question: Calculate the year-over-year growth rate for each product.\nColumns: product_id, year, sales\n\nAnswer:", "completion": " df.pivot_table(index='product_id', columns='year', values='sales').pct_change(axis=1)"}
{"prompt": "Question: Find the most common payment method for each product category.\nColumns: order_id, category, payment_method\n\nAnswer:", "completion": " df.groupby(['category', 'payment_method']).size().groupby('category').idxmax()"}
{"prompt": "Question: Calculate the average discount percentage for each product.\nColumns: product_id, original_price, sale_price\n\nAnswer:", "completion": " ((df['original_price'] - df['sale_price']) / df['original_price'] * 100).groupby(df['product_id']).mean()"}
{"prompt": "Question: Get the number of active users each month.\nColumns: user_id, activity_date\n\nAnswer:", "completion": " df['activity_date'].dt.to_period('M').value_counts().sort_index()"}
{"prompt": "Question: Find the products with the highest sales velocity (sales per day).\nColumns: product_id, sales, date\n\nAnswer:", "completion": " (df.groupby('product_id')['sales'].sum() / df.groupby('product_id')['date'].nunique()).nlargest(10)"}
{"prompt": "Question: Calculate the percentage of customers from each country.\nColumns: customer_id, country\n\nAnswer:", "completion": " df['country'].value_counts(normalize=True) * 100"}
{"prompt": "Question: Get the average order value by hour of day.\nColumns: order_id, amount, order_time\n\nAnswer:", "completion": " df.groupby(df['order_time'].dt.hour)['amount'].mean()"}
{"prompt": "Question: Find the most common product combinations in orders.\nColumns: order_id, product_id\n\nAnswer:", "completion": " from itertools import combinations; df.groupby('order_id')['product_id'].apply(lambda x: list(combinations(sorted(x), 2))).explode().value_counts()"}
{"prompt": "Question: Calculate the customer churn rate.\nColumns: customer_id, last_activity_date\n\nAnswer:", "completion": " (df['last_activity_date'] < pd.Timestamp.now() - pd.Timedelta(days=30)).mean() * 100"}
{"prompt": "Question: Get the average session duration for each traffic source.\nColumns: session_id, traffic_source, duration\n\nAnswer:", "completion": " df.groupby('traffic_source')['duration'].mean()"}
{"prompt": "Question: Find the products with the highest return rate.\nColumns: product_id, transaction_type\n\nAnswer:", "completion": " return_rate = df[df['transaction_type'] == 'return'].groupby('product_id').size() / df.groupby('product_id').size(); return_rate.nlargest(5)"}
{"prompt": "Question: Calculate the average customer acquisition cost by marketing channel.\nColumns: channel, acquisition_cost, customers_acquired\n\nAnswer:", "completion": " df.groupby('channel')['acquisition_cost'].sum() / df.groupby('channel')['customers_acquired'].sum()"}
{"prompt": "Question: Get the distribution of order sizes (number of items).\nColumns: order_id, items\n\nAnswer:", "completion": " df['items'].value_counts()"}
{"prompt": "Question: Find the correlation between product price and sales volume.\nColumns: product_id, price, sales_volume\n\nAnswer:", "completion": " df['price'].corr(df['sales_volume'])"}
{"prompt": "Question: Calculate the average time to first purchase for new customers.\nColumns: customer_id, signup_date, first_purchase_date\n\nAnswer:", "completion": " (df['first_purchase_date'] - df['signup_date']).mean()"}
{"prompt": "Question: Get the most common customer journey (sequence of pages visited).\nColumns: session_id, page_sequence\n\nAnswer:", "completion": " df['page_sequence'].value_counts().idxmax()"}
{"prompt": "Question: Calculate the inventory turnover ratio for each product.\nColumns: product_id, cost_of_goods_sold, average_inventory\n\nAnswer:", "completion": " df['cost_of_goods_sold'] / df['average_inventory']"}
{"prompt": "Question: Find the products with the highest profit margin.\nColumns: product_id, revenue, cost\n\nAnswer:", "completion": " ((df['revenue'] - df['cost']) / df['revenue']).groupby(df['product_id']).mean().nlargest(5)"}
{"prompt": "Question: Get the average customer rating for each product category.\nColumns: product_id, category, rating\n\nAnswer:", "completion": " df.groupby('category')['rating'].mean()"}
{"prompt": "Question: Calculate the monthly recurring revenue.\nColumns: customer_id, monthly_payment\n\nAnswer:", "completion": " df['monthly_payment'].sum()"}
{"prompt": "Question: Find the most effective marketing campaign by ROI.\nColumns: campaign_id, revenue, cost\n\nAnswer:", "completion": " ((df['revenue'] - df['cost']) / df['cost']).groupby(df['campaign_id']).mean().idxmax()"}
{"prompt": "Question: Get the average number of pageviews per session.\nColumns: session_id, pageviews\n\nAnswer:", "completion": " df['pageviews'].mean()"}
{"prompt": "Question: Calculate the customer satisfaction score (CSAT) for each product.\nColumns: product_id, satisfaction_score\n\nAnswer:", "completion": " df.groupby('product_id')['satisfaction_score'].mean()"}
{"prompt": "Question: Find the products that are frequently bought together.\nColumns: order_id, product_id\n\nAnswer:", "completion": " from mlxtend.frequent_patterns import apriori; from mlxtend.frequent_patterns import association_rules; basket = df.groupby(['order_id', 'product_id']).size().unstack().fillna(0); frequent_itemsets = apriori(basket, min_support=0.05, use_colnames=True); rules = association_rules(frequent_itemsets, metric='lift', min_threshold=1)"}
{"prompt": "Question: Calculate the average order processing time.\nColumns: order_id, order_date, shipment_date\n\nAnswer:", "completion": " (df['shipment_date'] - df['order_date']).mean()"}
{"prompt": "Question: Get the percentage of users who complete checkout after adding to cart.\nColumns: user_id, added_to_cart, completed_checkout\n\nAnswer:", "completion": " df['completed_checkout'].sum() / df['added_to_cart'].sum() * 100"}
{"prompt": "Question: Find the most common reasons for product returns.\nColumns: return_id, reason\n\nAnswer:", "completion": " df['reason'].value_counts()"}
{"prompt": "Question: Calculate the average customer lifespan.\nColumns: customer_id, first_purchase_date, last_purchase_date\n\nAnswer:", "completion": " (df['last_purchase_date'] - df['first_purchase_date']).mean()"}
{"prompt": "Question: Get the distribution of customer tenure in months.\nColumns: customer_id, tenure_months\n\nAnswer:", "completion": " df['tenure_months'].value_counts(bins=10)"}
{"prompt": "Question: Find the products with the highest seasonality in sales.\nColumns: product_id, date, sales\n\nAnswer:", "completion": " df.groupby('product_id')['sales'].std() / df.groupby('product_id')['sales'].mean()"}
{"prompt": "Question: Calculate the net promoter score (NPS).\nColumns: customer_id, nps_rating\n\nAnswer:", "completion": " promoters = (df['nps_rating'] >= 9).sum(); detractors = (df['nps_rating'] <= 6).sum(); (promoters - detractors) / len(df) * 100"}
{"prompt": "Question: Get the average cart abandonment rate by device type.\nColumns: session_id, device_type, abandoned_cart\n\nAnswer:", "completion": " df.groupby('device_type')['abandoned_cart'].mean() * 100"}
{"prompt": "Question: Find the most profitable customer segments.\nColumns: customer_id, segment, profit\n\nAnswer:", "completion": " df.groupby('segment')['profit'].sum().nlargest(5)"}
{"prompt": "Question: Calculate the customer lifetime value prediction.\nColumns: customer_id, average_order_value, purchase_frequency, customer_lifespan\n\nAnswer:", "completion": " df['average_order_value'] * df['purchase_frequency'] * df['customer_lifespan']"}
{"prompt": "Question: Get the conversion rate from visit to purchase for each traffic source.\nColumns: session_id, traffic_source, made_purchase\n\nAnswer:", "completion": " df.groupby('traffic_source')['made_purchase'].mean() * 100"}
{"prompt": "Question: Find the products with the highest inventory carrying cost.\nColumns: product_id, inventory_value, carrying_cost_rate\n\nAnswer:", "completion": " (df['inventory_value'] * df['carrying_cost_rate']).groupby(df['product_id']).sum().nlargest(5)"}
{"prompt": "Question: Calculate the average response time to customer inquiries.\nColumns: inquiry_id, inquiry_date, response_date\n\nAnswer:", "completion": " (df['response_date'] - df['inquiry_date']).mean()"}
{"prompt": "Question: Get the customer retention rate by cohort.\nColumns: customer_id, cohort_month, active_month\n\nAnswer:", "completion": " cohort_data = df.groupby(['cohort_month', 'active_month']).agg({'customer_id': 'nunique'}).unstack(0); cohort_data.div(cohort_data.iloc[:, 0], axis=0)"}
{"prompt": "Question: Find the most common customer support issues.\nColumns: ticket_id, issue_type\n\nAnswer:", "completion": " df['issue_type'].value_counts()"}
{"prompt": "Question: Calculate the average upsell value per customer.\nColumns: customer_id, upsell_amount\n\nAnswer:", "completion": " df.groupby('customer_id')['upsell_amount'].sum().mean()"}
{"prompt": "Question: Get the distribution of payment method preferences by country.\nColumns: country, payment_method\n\nAnswer:", "completion": " df.groupby(['country', 'payment_method']).size().unstack(fill_value=0)"}
{"prompt": "Question: Find the products with the best sell-through rate.\nColumns: product_id, units_sold, units_received\n\nAnswer:", "completion": " (df['units_sold'] / df['units_received']).groupby(df['product_id']).mean().nlargest(5)"}
{"prompt": "Question: Calculate the average customer support resolution time.\nColumns: ticket_id, created_date, resolved_date\n\nAnswer:", "completion": " (df['resolved_date'] - df['created_date']).mean()"}
{"prompt": "Question: Get the most common paths to purchase.\nColumns: session_id, path\n\nAnswer:", "completion": " df['path'].value_counts()"}
{"prompt": "Question: Find the products with the highest cross-selling potential.\nColumns: product_a, product_b, cross_sell_rate\n\nAnswer:", "completion": " df.nlargest(10, 'cross_sell_rate')"}
{"prompt": "Question: Calculate the average order value for mobile vs desktop users.\nColumns: order_id, device_type, amount\n\nAnswer:", "completion": " df.groupby('device_type')['amount'].mean()"}
{"prompt": "Question: Get the customer satisfaction trend over time.\nColumns: date, satisfaction_score\n\nAnswer:", "completion": " df.groupby('date')['satisfaction_score'].mean()"}
{"prompt": "Question: Find the most effective product recommendations.\nColumns: recommendation_id, click_through_rate\n\nAnswer:", "completion": " df.nlargest(5, 'click_through_rate')"}
{"prompt": "Question: Calculate the average customer effort score.\nColumns: customer_id, effort_score\n\nAnswer:", "completion": " df['effort_score'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings over time.\nColumns: date, rating\n\nAnswer:", "completion": " df.groupby('date')['rating'].value_counts().unstack(fill_value=0)"}
{"prompt": "Question: Find the products with the highest customer lifetime value.\nColumns: product_id, customer_lifetime_value\n\nAnswer:", "completion": " df.groupby('product_id')['customer_lifetime_value'].sum().nlargest(5)"}
{"prompt": "Question: Calculate the average response rate to marketing emails.\nColumns: campaign_id, emails_sent, responses_received\n\nAnswer:", "completion": " (df['responses_received'] / df['emails_sent']).mean() * 100"}
{"prompt": "Question: Get the most common customer personas based on purchase behavior.\nColumns: customer_id, persona\n\nAnswer:", "completion": " df['persona'].value_counts()"}
{"prompt": "Question: Find the products with the highest social media engagement.\nColumns: product_id, engagement_rate\n\nAnswer:", "completion": " df.nlargest(5, 'engagement_rate')"}
{"prompt": "Question: Calculate the average customer referral value.\nColumns: customer_id, referral_value\n\nAnswer:", "completion": " df['referral_value'].mean()"}
{"prompt": "Question: Get the distribution of customer satisfaction by product category.\nColumns: category, satisfaction_score\n\nAnswer:", "completion": " df.groupby('category')['satisfaction_score'].agg(['mean', 'std'])"}
{"prompt": "Question: Find the most profitable marketing channels.\nColumns: channel, revenue, cost\n\nAnswer:", "completion": " ((df['revenue'] - df['cost']) / df['cost']).groupby(df['channel']).mean().nlargest(5)"}
{"prompt": "Question: Calculate the average order fulfillment time.\nColumns: order_id, order_date, delivery_date\n\nAnswer:", "completion": " (df['delivery_date'] - df['order_date']).mean()"}
{"prompt": "Question: Get the customer churn prediction by segment.\nColumns: segment, churn_probability\n\nAnswer:", "completion": " df.groupby('segment')['churn_probability'].mean()"}
{"prompt": "Question: Find the products with the highest customer retention impact.\nColumns: product_id, retention_impact\n\nAnswer:", "completion": " df.nlargest(5, 'retention_impact')"}
{"prompt": "Question: Calculate the average customer support cost per ticket.\nColumns: ticket_id, support_cost\n\nAnswer:", "completion": " df['support_cost'].mean()"}
{"prompt": "Question: Get the distribution of product returns by reason.\nColumns: reason, return_count\n\nAnswer:", "completion": " df['return_count'].groupby(df['reason']).sum()"}
{"prompt": "Question: Find the most effective pricing strategies by product category.\nColumns: category, pricing_strategy, profitability\n\nAnswer:", "completion": " df.groupby(['category', 'pricing_strategy'])['profitability'].mean().groupby('category').idxmax()"}
{"prompt": "Question: Calculate the average customer acquisition cost by channel.\nColumns: channel, acquisition_cost, customers_acquired\n\nAnswer:", "completion": " df.groupby('channel')['acquisition_cost'].sum() / df.groupby('channel')['customers_acquired'].sum()"}
{"prompt": "Question: Get the customer lifetime value distribution.\nColumns: customer_id, lifetime_value\n\nAnswer:", "completion": " df['lifetime_value'].describe()"}
{"prompt": "Question: Find the products with the highest market share.\nColumns: product_id, market_share\n\nAnswer:", "completion": " df.nlargest(5, 'market_share')"}
{"prompt": "Question: Calculate the average order value growth rate.\nColumns: date, average_order_value\n\nAnswer:", "completion": " df['average_order_value'].pct_change() * 100"}
{"prompt": "Question: Get the most common customer journey stages where dropoffs occur.\nColumns: stage, dropoff_count\n\nAnswer:", "completion": " df.nlargest(5, 'dropoff_count')"}
{"prompt": "Question: Find the products with the highest customer satisfaction scores.\nColumns: product_id, satisfaction_score\n\nAnswer:", "completion": " df.groupby('product_id')['satisfaction_score'].mean().nlargest(5)"}
{"prompt": "Question: Calculate the average revenue per user by cohort.\nColumns: cohort, user_id, revenue\n\nAnswer:", "completion": " df.groupby(['cohort', 'user_id'])['revenue'].sum().groupby('cohort').mean()"}
{"prompt": "Question: Get the distribution of customer ratings by product feature.\nColumns: feature, rating\n\nAnswer:", "completion": " df.groupby('feature')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer retention strategies.\nColumns: strategy, retention_rate\n\nAnswer:", "completion": " df.nlargest(5, 'retention_rate')"}
{"prompt": "Question: Calculate the average customer support satisfaction score.\nColumns: ticket_id, satisfaction_score\n\nAnswer:", "completion": " df['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by acquisition channel.\nColumns: channel, churn_rate\n\nAnswer:", "completion": " df.groupby('channel')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest repeat purchase rate.\nColumns: product_id, repeat_purchase_rate\n\nAnswer:", "completion": " df.nlargest(5, 'repeat_purchase_rate')"}
{"prompt": "Question: Calculate the average order value for new vs existing customers.\nColumns: customer_type, order_value\n\nAnswer:", "completion": " df.groupby('customer_type')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer lifetime value by segment.\nColumns: segment, lifetime_value\n\nAnswer:", "completion": " df.groupby('segment')['lifetime_value'].describe()"}
{"prompt": "Question: Find the most profitable customer acquisition channels.\nColumns: channel, profitability\n\nAnswer:", "completion": " df.groupby('channel')['profitability'].sum().nlargest(5)"}
{"prompt": "Question: Calculate the average customer support response time by priority.\nColumns: priority, response_time\n\nAnswer:", "completion": " df.groupby('priority')['response_time'].mean()"}
{"prompt": "Question: Get the customer satisfaction trend by product category.\nColumns: category, date, satisfaction_score\n\nAnswer:", "completion": " df.groupby(['category', 'date'])['satisfaction_score'].mean().unstack(0)"}
{"prompt": "Question: Find the products with the highest customer referral rates.\nColumns: product_id, referral_rate\n\nAnswer:", "completion": " df.nlargest(5, 'referral_rate')"}
{"prompt": "Question: Calculate the average order processing time by fulfillment center.\nColumns: fulfillment_center, processing_time\n\nAnswer:", "completion": " df.groupby('fulfillment_center')['processing_time'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by support agent.\nColumns: agent_id, rating\n\nAnswer:", "completion": " df.groupby('agent_id')['rating'].mean()"}
{"prompt": "Question: Find the most effective product bundling strategies.\nColumns: bundle_strategy, profitability\n\nAnswer:", "completion": " df.groupby('bundle_strategy')['profitability'].mean().nlargest(5)"}
{"prompt": "Question: Calculate the average customer lifetime value by acquisition channel.\nColumns: channel, lifetime_value\n\nAnswer:", "completion": " df.groupby('channel')['lifetime_value'].mean()"}
{"prompt": "Question: Get the customer churn prediction accuracy.\nColumns: predicted_churn, actual_churn\n\nAnswer:", "completion": " (df['predicted_churn'] == df['actual_churn']).mean() * 100"}
{"prompt": "Question: Find the products with the highest customer engagement scores.\nColumns: product_id, engagement_score\n\nAnswer:", "completion": " df.nlargest(5, 'engagement_score')"}
{"prompt": "Question: Calculate the average order value by customer tenure.\nColumns: tenure, order_value\n\nAnswer:", "completion": " df.groupby('tenure')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer satisfaction by support channel.\nColumns: support_channel, satisfaction_score\n\nAnswer:", "completion": " df.groupby('support_channel')['satisfaction_score'].mean()"}
{"prompt": "Question: Find the most effective customer onboarding strategies.\nColumns: onboarding_strategy, success_rate\n\nAnswer:", "completion": " df.nlargest(5, 'success_rate')"}
{"prompt": "Question: Calculate the average customer support cost per resolved ticket.\nColumns: ticket_id, support_cost, resolved\n\nAnswer:", "completion": " df[df['resolved']]['support_cost'].mean()"}
{"prompt": "Question: Get the customer lifetime value prediction accuracy.\nColumns: predicted_ltv, actual_ltv\n\nAnswer:", "completion": " (df['predicted_ltv'] - df['actual_ltv']).abs().mean()"}
{"prompt": "Question: Find the products with the highest customer loyalty scores.\nColumns: product_id, loyalty_score\n\nAnswer:", "completion": " df.nlargest(5, 'loyalty_score')"}
{"prompt": "Question: Calculate the average order value by payment method.\nColumns: payment_method, order_value\n\nAnswer:", "completion": " df.groupby('payment_method')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by product version.\nColumns: version, rating\n\nAnswer:", "completion": " df.groupby('version')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer feedback collection methods.\nColumns: feedback_method, response_rate\n\nAnswer:", "completion": " df.nlargest(5, 'response_rate')"}
{"prompt": "Question: Calculate the average customer support resolution rate.\nColumns: agent_id, resolution_rate\n\nAnswer:", "completion": " df['resolution_rate'].mean()"}
{"prompt": "Question: Get the customer churn rate by product usage level.\nColumns: usage_level, churn_rate\n\nAnswer:", "completion": " df.groupby('usage_level')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer satisfaction improvement.\nColumns: product_id, satisfaction_improvement\n\nAnswer:", "completion": " df.nlargest(5, 'satisfaction_improvement')"}
{"prompt": "Question: Calculate the average order value by customer demographic.\nColumns: demographic, order_value\n\nAnswer:", "completion": " df.groupby('demographic')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by support topic.\nColumns: support_topic, rating\n\nAnswer:", "completion": " df.groupby('support_topic')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer retention campaigns.\nColumns: campaign_id, retention_rate\n\nAnswer:", "completion": " df.nlargest(5, 'retention_rate')"}
{"prompt": "Question: Calculate the average customer support satisfaction by agent experience.\nColumns: agent_experience, satisfaction_score\n\nAnswer:", "completion": " df.groupby('agent_experience')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer lifetime value by product usage pattern.\nColumns: usage_pattern, lifetime_value\n\nAnswer:", "completion": " df.groupby('usage_pattern')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer referral value.\nColumns: product_id, referral_value\n\nAnswer:", "completion": " df.nlargest(5, 'referral_value')"}
{"prompt": "Question: Calculate the average order value by time of day.\nColumns: order_time, order_value\n\nAnswer:", "completion": " df.groupby(df['order_time'].dt.hour)['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by product age.\nColumns: product_age, rating\n\nAnswer:", "completion": " df.groupby('product_age')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer support training programs.\nColumns: training_program, agent_performance\n\nAnswer:", "completion": " df.groupby('training_program')['agent_performance'].mean().nlargest(5)"}
{"prompt": "Question: Calculate the average customer support cost per interaction.\nColumns: interaction_id, support_cost\n\nAnswer:", "completion": " df['support_cost'].mean()"}
{"prompt": "Question: Get the customer churn rate by satisfaction level.\nColumns: satisfaction_level, churn_rate\n\nAnswer:", "completion": " df.groupby('satisfaction_level')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer engagement growth.\nColumns: product_id, engagement_growth\n\nAnswer:", "completion": " df.nlargest(5, 'engagement_growth')"}
{"prompt": "Question: Calculate the average order value by customer location.\nColumns: location, order_value\n\nAnswer:", "completion": " df.groupby('location')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by support duration.\nColumns: support_duration, rating\n\nAnswer:", "completion": " df.groupby('support_duration')['rating'].mean()"}
{"prompt": "Question: Find the most effective product launch strategies.\nColumns: launch_strategy, success_metric\n\nAnswer:", "completion": " df.nlargest(5, 'success_metric')"}
{"prompt": "Question: Calculate the average customer support satisfaction by issue complexity.\nColumns: issue_complexity, satisfaction_score\n\nAnswer:", "completion": " df.groupby('issue_complexity')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer lifetime value by acquisition source.\nColumns: acquisition_source, lifetime_value\n\nAnswer:", "completion": " df.groupby('acquisition_source')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer satisfaction consistency.\nColumns: product_id, satisfaction_consistency\n\nAnswer:", "completion": " df.nlargest(5, 'satisfaction_consistency')"}
{"prompt": "Question: Calculate the average order value by customer loyalty tier.\nColumns: loyalty_tier, order_value\n\nAnswer:", "completion": " df.groupby('loyalty_tier')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by response time.\nColumns: response_time, rating\n\nAnswer:", "completion": " df.groupby('response_time')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer feedback implementation strategies.\nColumns: implementation_strategy, improvement_metric\n\nAnswer:", "completion": " df.nlargest(5, 'improvement_metric')"}
{"prompt": "Question: Calculate the average customer support resolution time by issue type.\nColumns: issue_type, resolution_time\n\nAnswer:", "completion": " df.groupby('issue_type')['resolution_time'].mean()"}
{"prompt": "Question: Get the customer churn rate by product usage frequency.\nColumns: usage_frequency, churn_rate\n\nAnswer:", "completion": " df.groupby('usage_frequency')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer lifetime value growth.\nColumns: product_id, ltv_growth\n\nAnswer:", "completion": " df.nlargest(5, 'ltv_growth')"}
{"prompt": "Question: Calculate the average order value by customer age group.\nColumns: age_group, order_value\n\nAnswer:", "completion": " df.groupby('age_group')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by support quality.\nColumns: support_quality, rating\n\nAnswer:", "completion": " df.groupby('support_quality')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success initiatives.\nColumns: initiative, success_metric\n\nAnswer:", "completion": " df.nlargest(5, 'success_metric')"}
{"prompt": "Question: Calculate the average customer support cost per satisfied customer.\nColumns: customer_id, support_cost, satisfied\n\nAnswer:", "completion": " df[df['satisfied']]['support_cost'].mean()"}
{"prompt": "Question: Get the customer lifetime value by engagement level.\nColumns: engagement_level, lifetime_value\n\nAnswer:", "completion": " df.groupby('engagement_level')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer retention scores.\nColumns: product_id, retention_score\n\nAnswer:", "completion": " df.nlargest(5, 'retention_score')"}
{"prompt": "Question: Calculate the average order value by customer gender.\nColumns: gender, order_value\n\nAnswer:", "completion": " df.groupby('gender')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by product quality.\nColumns: product_quality, rating\n\nAnswer:", "completion": " df.groupby('product_quality')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer support tools.\nColumns: support_tool, efficiency_metric\n\nAnswer:", "completion": " df.nlargest(5, 'efficiency_metric')"}
{"prompt": "Question: Calculate the average customer support satisfaction by resolution time.\nColumns: resolution_time, satisfaction_score\n\nAnswer:", "completion": " df.groupby('resolution_time')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by customer satisfaction score.\nColumns: satisfaction_score, churn_rate\n\nAnswer:", "completion": " df.groupby('satisfaction_score')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer advocacy scores.\nColumns: product_id, advocacy_score\n\nAnswer:", "completion": " df.nlargest(5, 'advocacy_score')"}
{"prompt": "Question: Calculate the average order value by customer income level.\nColumns: income_level, order_value\n\nAnswer:", "completion": " df.groupby('income_level')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by value for money.\nColumns: value_for_money, rating\n\nAnswer:", "completion": " df.groupby('value_for_money')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer onboarding processes.\nColumns: onboarding_process, success_rate\n\nAnswer:", "completion": " df.nlargest(5, 'success_rate')"}
{"prompt": "Question: Calculate the average customer support cost per customer.\nColumns: customer_id, support_cost\n\nAnswer:", "completion": " df.groupby('customer_id')['support_cost'].sum().mean()"}
{"prompt": "Question: Get the customer lifetime value by product satisfaction.\nColumns: product_satisfaction, lifetime_value\n\nAnswer:", "completion": " df.groupby('product_satisfaction')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer loyalty growth.\nColumns: product_id, loyalty_growth\n\nAnswer:", "completion": " df.nlargest(5, 'loyalty_growth')"}
{"prompt": "Question: Calculate the average order value by customer education level.\nColumns: education_level, order_value\n\nAnswer:", "completion": " df.groupby('education_level')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by ease of use.\nColumns: ease_of_use, rating\n\nAnswer:", "completion": " df.groupby('ease_of_use')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer support workflows.\nColumns: workflow, efficiency_metric\n\nAnswer:", "completion": " df.nlargest(5, 'efficiency_metric')"}
{"prompt": "Question: Calculate the average customer support satisfaction by first contact resolution.\nColumns: first_contact_resolution, satisfaction_score\n\nAnswer:", "completion": " df.groupby('first_contact_resolution')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by product usage duration.\nColumns: usage_duration, churn_rate\n\nAnswer:", "completion": " df.groupby('usage_duration')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer satisfaction stability.\nColumns: product_id, satisfaction_stability\n\nAnswer:", "completion": " df.nlargest(5, 'satisfaction_stability')"}
{"prompt": "Question: Calculate the average order value by customer occupation.\nColumns: occupation, order_value\n\nAnswer:", "completion": " df.groupby('occupation')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by feature completeness.\nColumns: feature_completeness, rating\n\nAnswer:", "completion": " df.groupby('feature_completeness')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success metrics.\nColumns: success_metric, impact_score\n\nAnswer:", "completion": " df.nlargest(5, 'impact_score')"}
{"prompt": "Question: Calculate the average customer support cost per resolution.\nColumns: resolution_id, support_cost\n\nAnswer:", "completion": " df['support_cost'].mean()"}
{"prompt": "Question: Get the customer lifetime value by support satisfaction.\nColumns: support_satisfaction, lifetime_value\n\nAnswer:", "completion": " df.groupby('support_satisfaction')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer referral growth.\nColumns: product_id, referral_growth\n\nAnswer:", "completion": " df.nlargest(5, 'referral_growth')"}
{"prompt": "Question: Calculate the average order value by customer family size.\nColumns: family_size, order_value\n\nAnswer:", "completion": " df.groupby('family_size')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by reliability.\nColumns: reliability, rating\n\nAnswer:", "completion": " df.groupby('reliability')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer support training methods.\nColumns: training_method, effectiveness_score\n\nAnswer:", "completion": " df.nlargest(5, 'effectiveness_score')"}
{"prompt": "Question: Calculate the average customer support satisfaction by agent communication skills.\nColumns: communication_skills, satisfaction_score\n\nAnswer:", "completion": " df.groupby('communication_skills')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by product feature usage.\nColumns: feature_usage, churn_rate\n\nAnswer:", "completion": " df.groupby('feature_usage')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer engagement stability.\nColumns: product_id, engagement_stability\n\nAnswer:", "completion": " df.nlargest(5, 'engagement_stability')"}
{"prompt": "Question: Calculate the average order value by customer housing type.\nColumns: housing_type, order_value\n\nAnswer:", "completion": " df.groupby('housing_type')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by performance.\nColumns: performance, rating\n\nAnswer:", "completion": " df.groupby('performance')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer feedback analysis methods.\nColumns: analysis_method, insight_score\n\nAnswer:", "completion": " df.nlargest(5, 'insight_score')"}
{"prompt": "Question: Calculate the average customer support cost per minute.\nColumns: support_time, support_cost\n\nAnswer:", "completion": " df['support_cost'].sum() / df['support_time'].sum()"}
{"prompt": "Question: Get the customer lifetime value by product usage intensity.\nColumns: usage_intensity, lifetime_value\n\nAnswer:", "completion": " df.groupby('usage_intensity')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer satisfaction growth rate.\nColumns: product_id, satisfaction_growth\n\nAnswer:", "completion": " df.nlargest(5, 'satisfaction_growth')"}
{"prompt": "Question: Calculate the average order value by customer transportation method.\nColumns: transportation_method, order_value\n\nAnswer:", "completion": " df.groupby('transportation_method')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by design.\nColumns: design, rating\n\nAnswer:", "completion": " df.groupby('design')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer support quality measures.\nColumns: quality_measure, effectiveness_score\n\nAnswer:", "completion": " df.nlargest(5, 'effectiveness_score')"}
{"prompt": "Question: Calculate the average customer support satisfaction by problem complexity.\nColumns: problem_complexity, satisfaction_score\n\nAnswer:", "completion": " df.groupby('problem_complexity')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by customer effort score.\nColumns: effort_score, churn_rate\n\nAnswer:", "completion": " df.groupby('effort_score')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer loyalty consistency.\nColumns: product_id, loyalty_consistency\n\nAnswer:", "completion": " df.nlargest(5, 'loyalty_consistency')"}
{"prompt": "Question: Calculate the average order value by customer pet ownership.\nColumns: pet_ownership, order_value\n\nAnswer:", "completion": " df.groupby('pet_ownership')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by innovation.\nColumns: innovation, rating\n\nAnswer:", "completion": " df.groupby('innovation')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success measurement approaches.\nColumns: measurement_approach, accuracy_score\n\nAnswer:", "completion": " df.nlargest(5, 'accuracy_score')"}
{"prompt": "Question: Calculate the average customer support cost per interaction type.\nColumns: interaction_type, support_cost\n\nAnswer:", "completion": " df.groupby('interaction_type')['support_cost'].mean()"}
{"prompt": "Question: Get the customer lifetime value by customer health score.\nColumns: health_score, lifetime_value\n\nAnswer:", "completion": " df.groupby('health_score')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer advocacy growth.\nColumns: product_id, advocacy_growth\n\nAnswer:", "completion": " df.nlargest(5, 'advocacy_growth')"}
{"prompt": "Question: Calculate the average order value by customer hobby.\nColumns: hobby, order_value\n\nAnswer:", "completion": " df.groupby('hobby')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by customization.\nColumns: customization, rating\n\nAnswer:", "completion": " df.groupby('customization')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer support performance indicators.\nColumns: performance_indicator, relevance_score\n\nAnswer:", "completion": " df.nlargest(5, 'relevance_score')"}
{"prompt": "Question: Calculate the average customer support satisfaction by solution quality.\nColumns: solution_quality, satisfaction_score\n\nAnswer:", "completion": " df.groupby('solution_quality')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by customer support satisfaction.\nColumns: support_satisfaction, churn_rate\n\nAnswer:", "completion": " df.groupby('support_satisfaction')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer retention consistency.\nColumns: product_id, retention_consistency\n\nAnswer:", "completion": " df.nlargest(5, 'retention_consistency')"}
{"prompt": "Question: Calculate the average order value by customer sports preference.\nColumns: sports_preference, order_value\n\nAnswer:", "completion": " df.groupby('sports_preference')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by compatibility.\nColumns: compatibility, rating\n\nAnswer:", "completion": " df.groupby('compatibility')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success intervention strategies.\nColumns: intervention_strategy, success_rate\n\nAnswer:", "completion": " df.nlargest(5, 'success_rate')"}
{"prompt": "Question: Calculate the average customer support cost per customer segment.\nColumns: customer_segment, support_cost\n\nAnswer:", "completion": " df.groupby('customer_segment')['support_cost'].mean()"}
{"prompt": "Question: Get the customer lifetime value by product adoption rate.\nColumns: adoption_rate, lifetime_value\n\nAnswer:", "completion": " df.groupby('adoption_rate')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer satisfaction predictability.\nColumns: product_id, satisfaction_predictability\n\nAnswer:", "completion": " df.nlargest(5, 'satisfaction_predictability')"}
{"prompt": "Question: Calculate the average order value by customer music preference.\nColumns: music_preference, order_value\n\nAnswer:", "completion": " df.groupby('music_preference')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by security.\nColumns: security, rating\n\nAnswer:", "completion": " df.groupby('security')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer support escalation procedures.\nColumns: escalation_procedure, effectiveness_score\n\nAnswer:", "completion": " df.nlargest(5, 'effectiveness_score')"}
{"prompt": "Question: Calculate the average customer support satisfaction by empathy shown.\nColumns: empathy_shown, satisfaction_score\n\nAnswer:", "completion": " df.groupby('empathy_shown')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by product update frequency.\nColumns: update_frequency, churn_rate\n\nAnswer:", "completion": " df.groupby('update_frequency')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer engagement predictability.\nColumns: product_id, engagement_predictability\n\nAnswer:", "completion": " df.nlargest(5, 'engagement_predictability')"}
{"prompt": "Question: Calculate the average order value by customer reading preference.\nColumns: reading_preference, order_value\n\nAnswer:", "completion": " df.groupby('reading_preference')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by scalability.\nColumns: scalability, rating\n\nAnswer:", "completion": " df.groupby('scalability')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success communication methods.\nColumns: communication_method, effectiveness_score\n\nAnswer:", "completion": " df.nlargest(5, 'effectiveness_score')"}
{"prompt": "Question: Calculate the average customer support cost per issue severity.\nColumns: issue_severity, support_cost\n\nAnswer:", "completion": " df.groupby('issue_severity')['support_cost'].mean()"}
{"prompt": "Question: Get the customer lifetime value by feature utilization.\nColumns: feature_utilization, lifetime_value\n\nAnswer:", "completion": " df.groupby('feature_utilization')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer loyalty predictability.\nColumns: product_id, loyalty_predictability\n\nAnswer:", "completion": " df.nlargest(5, 'loyalty_predictability')"}
{"prompt": "Question: Calculate the average order value by customer travel frequency.\nColumns: travel_frequency, order_value\n\nAnswer:", "completion": " df.groupby('travel_frequency')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by integration.\nColumns: integration, rating\n\nAnswer:", "completion": " df.groupby('integration')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer support knowledge management systems.\nColumns: knowledge_system, efficiency_score\n\nAnswer:", "completion": " df.nlargest(5, 'efficiency_score')"}
{"prompt": "Question: Calculate the average customer support satisfaction by response accuracy.\nColumns: response_accuracy, satisfaction_score\n\nAnswer:", "completion": " df.groupby('response_accuracy')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by customer education level.\nColumns: education_level, churn_rate\n\nAnswer:", "completion": " df.groupby('education_level')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer advocacy predictability.\nColumns: product_id, advocacy_predictability\n\nAnswer:", "completion": " df.nlargest(5, 'advocacy_predictability')"}
{"prompt": "Question: Calculate the average order value by customer social media usage.\nColumns: social_media_usage, order_value\n\nAnswer:", "completion": " df.groupby('social_media_usage')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by documentation.\nColumns: documentation, rating\n\nAnswer:", "completion": " df.groupby('documentation')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success onboarding processes.\nColumns: onboarding_process, success_rate\n\nAnswer:", "completion": " df.nlargest(5, 'success_rate')"}
{"prompt": "Question: Calculate the average customer support cost per resolution type.\nColumns: resolution_type, support_cost\n\nAnswer:", "completion": " df.groupby('resolution_type')['support_cost'].mean()"}
{"prompt": "Question: Get the customer lifetime value by support ticket frequency.\nColumns: ticket_frequency, lifetime_value\n\nAnswer:", "completion": " df.groupby('ticket_frequency')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer retention predictability.\nColumns: product_id, retention_predictability\n\nAnswer:", "completion": " df.nlargest(5, 'retention_predictability')"}
{"prompt": "Question: Calculate the average order value by customer gaming preference.\nColumns: gaming_preference, order_value\n\nAnswer:", "completion": " df.groupby('gaming_preference')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by support availability.\nColumns: support_availability, rating\n\nAnswer:", "completion": " df.groupby('support_availability')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success metrics tracking systems.\nColumns: tracking_system, accuracy_score\n\nAnswer:", "completion": " df.nlargest(5, 'accuracy_score')"}
{"prompt": "Question: Calculate the average customer support satisfaction by follow-up quality.\nColumns: follow_up_quality, satisfaction_score\n\nAnswer:", "completion": " df.groupby('follow_up_quality')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by income level.\nColumns: income_level, churn_rate\n\nAnswer:", "completion": " df.groupby('income_level')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer satisfaction correlation.\nColumns: product_id, satisfaction_correlation\n\nAnswer:", "completion": " df.nlargest(5, 'satisfaction_correlation')"}
{"prompt": "Question: Calculate the average order value by customer dietary preference.\nColumns: dietary_preference, order_value\n\nAnswer:", "completion": " df.groupby('dietary_preference')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by update frequency.\nColumns: update_frequency, rating\n\nAnswer:", "completion": " df.groupby('update_frequency')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success feedback loops.\nColumns: feedback_loop, effectiveness_score\n\nAnswer:", "completion": " df.nlargest(5, 'effectiveness_score')"}
{"prompt": "Question: Calculate the average customer support cost per customer value tier.\nColumns: value_tier, support_cost\n\nAnswer:", "completion": " df.groupby('value_tier')['support_cost'].mean()"}
{"prompt": "Question: Get the customer lifetime value by product usage patterns.\nColumns: usage_pattern, lifetime_value\n\nAnswer:", "completion": " df.groupby('usage_pattern')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer engagement correlation.\nColumns: product_id, engagement_correlation\n\nAnswer:", "completion": " df.nlargest(5, 'engagement_correlation')"}
{"prompt": "Question: Calculate the average order value by customer environmental concern.\nColumns: environmental_concern, order_value\n\nAnswer:", "completion": " df.groupby('environmental_concern')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by community support.\nColumns: community_support, rating\n\nAnswer:", "completion": " df.groupby('community_support')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success collaboration tools.\nColumns: collaboration_tool, efficiency_score\n\nAnswer:", "completion": " df.nlargest(5, 'efficiency_score')"}
{"prompt": "Question: Calculate the average customer support satisfaction by professionalism.\nColumns: professionalism, satisfaction_score\n\nAnswer:", "completion": " df.groupby('professionalism')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by geographic region.\nColumns: region, churn_rate\n\nAnswer:", "completion": " df.groupby('region')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer loyalty correlation.\nColumns: product_id, loyalty_correlation\n\nAnswer:", "completion": " df.nlargest(5, 'loyalty_correlation')"}
{"prompt": "Question: Calculate the average order value by customer political affiliation.\nColumns: political_affiliation, order_value\n\nAnswer:", "completion": " df.groupby('political_affiliation')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by training resources.\nColumns: training_resources, rating\n\nAnswer:", "completion": " df.groupby('training_resources')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success analytics platforms.\nColumns: analytics_platform, insight_score\n\nAnswer:", "completion": " df.nlargest(5, 'insight_score')"}
{"prompt": "Question: Calculate the average customer support cost per industry vertical.\nColumns: industry_vertical, support_cost\n\nAnswer:", "completion": " df.groupby('industry_vertical')['support_cost'].mean()"}
{"prompt": "Question: Get the customer lifetime value by company size.\nColumns: company_size, lifetime_value\n\nAnswer:", "completion": " df.groupby('company_size')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer advocacy correlation.\nColumns: product_id, advocacy_correlation\n\nAnswer:", "completion": " df.nlargest(5, 'advocacy_correlation')"}
{"prompt": "Question: Calculate the average order value by customer technology adoption.\nColumns: technology_adoption, order_value\n\nAnswer:", "completion": " df.groupby('technology_adoption')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by customization options.\nColumns: customization_options, rating\n\nAnswer:", "completion": " df.groupby('customization_options')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success reporting systems.\nColumns: reporting_system, clarity_score\n\nAnswer:", "completion": " df.nlargest(5, 'clarity_score')"}
{"prompt": "Question: Calculate the average customer support satisfaction by technical knowledge.\nColumns: technical_knowledge, satisfaction_score\n\nAnswer:", "completion": " df.groupby('technical_knowledge')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by tenure length.\nColumns: tenure_length, churn_rate\n\nAnswer:", "completion": " df.groupby('tenure_length')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer retention correlation.\nColumns: product_id, retention_correlation\n\nAnswer:", "completion": " df.nlargest(5, 'retention_correlation')"}
{"prompt": "Question: Calculate the average order value by customer health consciousness.\nColumns: health_consciousness, order_value\n\nAnswer:", "completion": " df.groupby('health_consciousness')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by mobile experience.\nColumns: mobile_experience, rating\n\nAnswer:", "completion": " df.groupby('mobile_experience')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success goal setting methods.\nColumns: goal_setting_method, achievement_rate\n\nAnswer:", "completion": " df.nlargest(5, 'achievement_rate')"}
{"prompt": "Question: Calculate the average customer support cost per support channel.\nColumns: support_channel, support_cost\n\nAnswer:", "completion": " df.groupby('support_channel')['support_cost'].mean()"}
{"prompt": "Question: Get the customer lifetime value by innovation adoption.\nColumns: innovation_adoption, lifetime_value\n\nAnswer:", "completion": " df.groupby('innovation_adoption')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer satisfaction impact.\nColumns: product_id, satisfaction_impact\n\nAnswer:", "completion": " df.nlargest(5, 'satisfaction_impact')"}
{"prompt": "Question: Calculate the average order value by customer fashion sense.\nColumns: fashion_sense, order_value\n\nAnswer:", "completion": " df.groupby('fashion_sense')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by data privacy.\nColumns: data_privacy, rating\n\nAnswer:", "completion": " df.groupby('data_privacy')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success coaching methods.\nColumns: coaching_method, improvement_score\n\nAnswer:", "completion": " df.nlargest(5, 'improvement_score')"}
{"prompt": "Question: Calculate the average customer support satisfaction by patience shown.\nColumns: patience_shown, satisfaction_score\n\nAnswer:", "completion": " df.groupby('patience_shown')['satisfaction_score'].mean()"}
{"prompt": "Question: Get the customer churn rate by product complexity.\nColumns: product_complexity, churn_rate\n\nAnswer:", "completion": " df.groupby('product_complexity')['churn_rate'].mean()"}
{"prompt": "Question: Find the products with the highest customer engagement impact.\nColumns: product_id, engagement_impact\n\nAnswer:", "completion": " df.nlargest(5, 'engagement_impact')"}
{"prompt": "Question: Calculate the average order value by customer home ownership.\nColumns: home_ownership, order_value\n\nAnswer:", "completion": " df.groupby('home_ownership')['order_value'].mean()"}
{"prompt": "Question: Get the distribution of customer ratings by API quality.\nColumns: api_quality, rating\n\nAnswer:", "completion": " df.groupby('api_quality')['rating'].mean()"}
{"prompt": "Question: Find the most effective customer success certification programs.\nColumns: certification_program, completion_rate\n\nAnswer:", "completion": " df.nlargest(5, 'completion_rate')"}
{"prompt": "Question: Calculate the average customer support cost per language.\nColumns: language, support_cost\n\nAnswer:", "completion": " df.groupby('language')['support_cost'].mean()"}
{"prompt": "Question: Get the customer lifetime value by digital literacy.\nColumns: digital_literacy, lifetime_value\n\nAnswer:", "completion": " df.groupby('digital_literacy')['lifetime_value'].mean()"}
{"prompt": "Question: Find the products with the highest customer loyalty impact.\nColumns: product_id, loyalty_impact\n\n\u6781\u901f\u5feb3Answer:", "completion": " df.nlargest(5, 'loyalty_impact')"}
{"prompt": "Question: Pivot table showing total quantity for each employee per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.pivot_table(index='employee_id', columns='product_id', values='quantity', aggfunc='sum')"}
{"prompt": "Question: Add a column 'high_price' which is True if price > 100.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['high_price'] = df['price'] > 100"}
{"prompt": "Question: Filter rows where product_id is 'P123'.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['product_id'] == 'P123']"}
{"prompt": "Question: Find the minimum quantity sold per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['quantity'].min()"}
{"prompt": "Question: Sort the dataset by quantity ascending and then price descending.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.sort_values(['quantity', 'price'], ascending=[True, False])"}
{"prompt": "Question: Remove duplicate rows based on employee_id and product_id.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.drop_duplicates(subset=['employee_id', 'product_id'])"}
{"prompt": "Question: Create a column 'month' from sale_date.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['month'] = df['sale_date'].dt.month"}
{"prompt": "Question: Count number of sales per month.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby(df['sale_date'].dt.month).size()"}
{"prompt": "Question: Filter rows where price is not null.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['price'].notnull()]"}
{"prompt": "Question: Get summary statistics for quantity and price.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[['quantity', 'price']].describe()"}
{"prompt": "Question: Merge df with df_suppliers on product_id using left join.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.merge(df_suppliers, on='product_id', how='left')"}
{"prompt": "Question: Filter rows where employee_id is in [101, 102, 103].\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['employee_id'].isin([101, 102, 103])]"}
{"prompt": "Question: Round the price column to 2 decimal places.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['price'] = df['price'].round(2)"}
{"prompt": "Question: Replace missing quantities with 0.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['quantity'].fillna(0, inplace=True)"}
{"prompt": "Question: Create a column 'revenue_category' based on total_cost > 500.\nColumns: employee_id, product_id, quantity, price, sale_date, total_cost\n\nAnswer:", "completion": "df['revenue_category'] = df['total_cost'].apply(lambda x: 'High' if x > 500 else 'Low')"}
{"prompt": "Question: Find the top 3 employees by total revenue.\nColumns: employee_id, product_id, quantity, price, sale_date, total_cost\n\nAnswer:", "completion": "df.groupby('employee_id')['total_cost'].sum().nlargest(3)"}
{"prompt": "Question: Select rows where sale_date is after 2024-01-01.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['sale_date'] > '2024-01-01']"}
{"prompt": "Question: Calculate cumulative sum of quantity for each employee.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.sort_values('sale_date').groupby('employee_id')['quantity'].cumsum()"}
{"prompt": "Question: Filter rows where total_cost is between 100 and 500.\nColumns: employee_id, product_id, quantity, price, sale_date, total_cost\n\nAnswer:", "completion": "df[df['total_cost'].between(100, 500)]"}
{"prompt": "Question: Count number of unique employees per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['employee_id'].nunique()"}
{"prompt": "Question: Find average price for each month.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby(df['sale_date'].dt.month)['price'].mean()"}
{"prompt": "Question: Create a flag column 'big_sale' if quantity > 20.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['big_sale'] = df['quantity'] > 20"}
{"prompt": "Question: Select rows where employee_id is not 105.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[df['employee_id'] != 105]"}
{"prompt": "Question: Create a column 'quarter' based on sale_date.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df['quarter'] = df['sale_date'].dt.quarter"}
{"prompt": "Question: Filter rows where quarter is 1.\nColumns: employee_id, product_id, quantity, price, sale_date, quarter\n\nAnswer:", "completion": "df[df['quarter'] == 1]"}
{"prompt": "Question: Get mean and median price per product.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.groupby('product_id')['price'].agg(['mean', 'median'])"}
{"prompt": "Question: Get top 5 most expensive products.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df.nlargest(5, 'price')"}
{"prompt": "Question: Filter rows where employee_id is 101 and quantity > 10.\nColumns: employee_id, product_id, quantity, price, sale_date\n\nAnswer:", "completion": "df[(df['employee_id']==101) & (df['quantity']>10)]"}
